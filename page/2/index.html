<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5J42R3VH2D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5J42R3VH2D');
</script>

  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.7.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"taccisum.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="el psy congroo.">
<meta property="og:type" content="website">
<meta property="og:title" content="Taccisum&#39;s blog ğŸ˜‰">
<meta property="og:url" content="https://taccisum.github.io/page/2/index.html">
<meta property="og:site_name" content="Taccisum&#39;s blog ğŸ˜‰">
<meta property="og:description" content="el psy congroo.">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Taccisum&#39;s blog ğŸ˜‰">
<meta name="twitter:description" content="el psy congroo.">

<link rel="canonical" href="https://taccisum.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Taccisum's blog ğŸ˜‰</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Taccisum's blog ğŸ˜‰</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/source/zuul/architecture.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/source/zuul/architecture.html" class="post-title-link" itemprop="url">zuulæºç è§£æ â€”â€” zuulæ•´ä½“æ¶æ„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-29 10:55:13" itemprop="dateCreated datePublished" datetime="2018-11-29T10:55:13+08:00">2018-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/" itemprop="url" rel="index"><span itemprop="name">source</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/zuul/" itemprop="url" rel="index"><span itemprop="name">zuul</span></a>
                </span>
            </span>

          
            <span id="/source/zuul/architecture.html" class="post-meta-item leancloud_visitors" data-flag-title="zuulæºç è§£æ â€”â€” zuulæ•´ä½“æ¶æ„" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/source/zuul/architecture.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/source/zuul/architecture.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><p>å…³äºzuulæ¶æ„ï¼Œå®˜æ–¹çš„<a href="https://github.com/Netflix/zuul/wiki/How-it-Works" target="_blank" rel="noopener">How-it-Works</a>å·²ç»è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œç®€å•åœ°ç¿»è¯‘ä¸€ä¸‹ï¼š</p>
<p>Zuulçš„æ ¸å¿ƒå°±æ˜¯ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œèƒ½å¤Ÿåœ¨HTTPè¯·æ±‚å’Œå“åº”çš„è¿‡ç¨‹ä¸­è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œã€‚Zuulæä¾›äº†ä¸€ä¸ªå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è¯»å–ã€ç¼–è¯‘å¹¶è¿è¡Œè¿™äº›è¿‡æ»¤å™¨çš„æ¡†æ¶ã€‚<br>ä»¥ä¸‹æ˜¯è¿‡æ»¤å™¨çš„ä¸€äº›é‡è¦å±æ€§ï¼š  </p>
<ul>
<li><strong>ç±»å‹</strong>ï¼šé€šå¸¸å®šä¹‰äº†è¿‡æ»¤å™¨ä¼šä½œç”¨åœ¨è·¯ç”±çš„å“ªä¸ªé˜¶æ®µ</li>
<li><strong>æ‰§è¡Œé¡ºåº</strong>ï¼šå½“åŒä¸€é˜¶æ®µå­˜åœ¨å¤šä¸ªè¿‡æ»¤å™¨æ—¶ï¼Œå†³å®šäº†è¿™äº›è¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåº</li>
<li><strong>æ‰§è¡Œæ¡ä»¶</strong>ï¼šå†³å®šè¿‡æ»¤å™¨æ˜¯å¦è¢«æ‰§è¡Œ</li>
<li><strong>è¡Œä¸º</strong>ï¼šå½“ç¬¦åˆæ¡ä»¶çš„æ—¶å€™æ‰§è¡Œçš„æ“ä½œ</li>
</ul>
<p>è¿‡æ»¤å™¨ä¹‹é—´ä¸ä¼šç›´æ¥è¿›è¡Œé€šä¿¡ï¼Œè€Œæ˜¯é€šè¿‡æ¯ä¸ªè¯·æ±‚å”¯ä¸€å¯¹åº”çš„RequestContextå®ä¾‹è¿›è¡ŒçŠ¶æ€å…±äº«ã€‚<br>è¿‡æ»¤å™¨ç›®å‰åªèƒ½é€šè¿‡Groovyè¯­è¨€ç¼–å†™ï¼ˆæŒ‡çš„æ˜¯åŠ¨æ€è¿‡æ»¤å™¨ï¼‰ï¼Œå°½ç®¡ä»ç†è®ºä¸Šæ¥è¯´Zuulæ”¯æŒæ‰€æœ‰ä»¥JVMä¸ºæ‰§è¡Œç¯å¢ƒçš„è¯­è¨€ã€‚<br>è¿‡æ»¤å™¨çš„æºç åº”è¯¥å†™åˆ°æŒ‡å®šçš„ç›®å½•ä¸­ï¼ŒZuul Serverä¼šå‘¨æœŸæ€§åœ°æ£€æŸ¥è¿™äº›ç›®å½•çš„å˜åŒ–ã€‚ä¸€æ—¦æŸäº›è¿‡æ»¤å™¨æœ‰æ›´æ–°ï¼Œå®ƒä»¬å°†ä¼šè¢«Zuulè¯»å–å¹¶åŠ¨æ€åœ°ç¼–è¯‘åˆ°è¿è¡Œæ—¶ç¯å¢ƒä¸­ï¼Œåœ¨éšååˆ°æ¥çš„æ¯ä¸ªè¯·æ±‚ä¸­éƒ½å°†è¢«Zuulè°ƒç”¨ã€‚</p>
<p><img src="/images/zuul/architecture.png" alt="zuul_architecture"></p>
<blockquote>
<p>å›¾ç‰‡æ¥æº - <a href="https://medium.com/netflix-techblog/announcing-zuul-edge-service-in-the-cloud-ab3af5be08ee" target="_blank" rel="noopener">netflix techblog</a></p>
</blockquote>
<h2 id="æ ¸å¿ƒç±»"><a href="#æ ¸å¿ƒç±»" class="headerlink" title="æ ¸å¿ƒç±»"></a>æ ¸å¿ƒç±»</h2><h3 id="ZuulServlet"><a href="#ZuulServlet" class="headerlink" title="ZuulServlet"></a>ZuulServlet</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- web.xml --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ZuulServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>com.netflix.zuul.http.ZuulServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ZuulServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Zuulæ˜¯ä¸€ä¸ªwebåº”ç”¨ï¼Œåœ¨web.xmlä¸­å…¶ä½¿ç”¨çš„Servletå®ç°æ˜¯ZuulServletã€‚å› æ­¤æ¯«æ— ç–‘é—®çš„ï¼ŒZuulServletå°±æ˜¯æ•´ä¸ªZuulçš„æ ¸å¿ƒã€‚</p>
<p>æ¥çœ‹çœ‹servieræ–¹æ³•</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// ZuulServlet.java</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span>javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletRequest servletRequest<span class="token punctuation">,</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletResponse servletResponse<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// åˆå§‹åŒ–å½“å‰çš„zuul request contextï¼Œå°†requestå’Œresponseæ”¾å…¥ä¸Šä¸‹æ–‡ä¸­</span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HttpServletRequest<span class="token punctuation">)</span> servletRequest<span class="token punctuation">,</span> <span class="token punctuation">(</span>HttpServletResponse<span class="token punctuation">)</span> servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// Marks this request as having passed through the "Zuul engine", as opposed to servlets</span>
        <span class="token comment" spellcheck="true">// explicitly bound in web.xml, for which requests will not have the same data attached</span>
        RequestContext context <span class="token operator">=</span> RequestContext<span class="token punctuation">.</span><span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ä¸ºæ­¤æ¬¡è¯·æ±‚è®¾ç½®æ ‡è¯†</span>
        context<span class="token punctuation">.</span><span class="token function">setZuulEngineRan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// zuulå¯¹è¯·æ±‚çš„å¤„ç†æµç¨‹ start</span>
        <span class="token comment" spellcheck="true">// ä»¥ä¸‹å‡ ä¸ªtryå—éƒ¨åˆ†æ˜¯zuulå¯¹ä¸€ä¸ªè¯·æ±‚çš„å¤„ç†æµç¨‹ï¼špre -> route -> post</span>
        <span class="token comment" spellcheck="true">// å¯ä»¥çœ‹åˆ°ï¼š</span>
        <span class="token comment" spellcheck="true">// 1. postæ˜¯å¿…ç„¶æ‰§è¡Œçš„ï¼ˆå¯ä»¥ç±»æ¯”finallyå—ï¼‰ï¼Œä½†å¦‚æœåœ¨postä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œäº¤ç”±errorå¤„ç†å®Œåå°±ç»“æŸï¼Œé¿å…æ— é™å¾ªç¯</span>
        <span class="token comment" spellcheck="true">// 2. ä»»ä½•é˜¶æ®µæŠ›å‡ºäº†ZuulExceptionï¼Œéƒ½ä¼šäº¤ç”±errorå¤„ç†</span>
        <span class="token comment" spellcheck="true">// 3. éZuulExceptionä¼šè¢«å°è£…åäº¤ç»™errorå¤„ç†</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">preRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ZuulException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">postRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ZuulException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">postRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">postRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ZuulException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// zuulå¯¹è¯·æ±‚çš„å¤„ç†æµç¨‹ end</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ZuulException</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"UNHANDLED_EXCEPTION_"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// æ­¤æ¬¡è¯·æ±‚å®Œæˆï¼Œç§»é™¤ç›¸åº”çš„ä¸Šä¸‹æ–‡å¯¹è±¡</span>
        RequestContext<span class="token punctuation">.</span><span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸Šé¢ä»£ç é€»è¾‘æ­£å¥½zuulå®˜æ–¹çš„æ¶æ„å›¾ç›¸å¯¹åº”</p>
<p><img src="https://camo.githubusercontent.com/4eb7754152028cdebd5c09d1c6f5acc7683f0094/687474703a2f2f6e6574666c69782e6769746875622e696f2f7a75756c2f696d616765732f7a75756c2d726571756573742d6c6966656379636c652e706e67" alt="zuul_architecture1"></p>
<h3 id="RequestContext"><a href="#RequestContext" class="headerlink" title="RequestContext"></a>RequestContext</h3><p>RequestContextæ˜¯å„filterä¹‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’çš„ä»‹è´¨ï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªMapï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸­å­˜å‚¨ä»»ä½•kv pairã€‚</p>
<p><strong>TODO::</strong> è¿™é‡Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆRequestContextæ˜¯ç»§æ‰¿è‡ªConcurrentHashMapï¼Ÿå› ä¸ºç†è®ºä¸Šæ¥è¯´RequestContextå¯¹è±¡æ˜¯ç»å¯¹çº¿ç¨‹å®‰å…¨çš„ï¼ˆçº¿ç¨‹éš”ç¦»ï¼‰ã€‚</p>
<p>RequestContextåŒ…å«ä¸€ä¸ªç±»å˜é‡threadLocalï¼Œ</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> ThreadLocal<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">RequestContext</span><span class="token operator">></span> threadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token operator">&lt;</span>RequestContext<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> RequestContext <span class="token function">initialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// ä¸Šä¸‹æ–‡å®ä¾‹ç±»å‹å–å†³äºcontextClassï¼Œä¾‹å¦‚åœ¨NFRequestContextä¸­å°±æ”¹å†™äº†contextClass</span>
            <span class="token keyword">return</span> contextClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨ä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥é€šè¿‡é™æ€æ–¹æ³•getCurrentContextè·å–åˆ°å±äºå½“å‰çº¿ç¨‹ï¼ˆå®é™…ä¸Šç»è¿‡zuulçš„å¤„ç†ï¼Œcontextå®ä¾‹æ˜¯æŒ‰è¯·æ±‚éš”ç¦»çš„ï¼‰çš„RequestContextå®ä¾‹</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> RequestContext <span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>testContext <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> testContext<span class="token punctuation">;</span>

    RequestContext context <span class="token operator">=</span> threadLocal<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> context<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="NFRequestContext"><a href="#NFRequestContext" class="headerlink" title="NFRequestContext"></a>NFRequestContext</h4><p><code>NFRequestContext</code>ç»§æ‰¿è‡ªRequestContextï¼Œå®šä¹‰äº†ä¸€äº›ä¸netflixå…¶å®ƒç»„ä»¶æœ‰å…³çš„ç‰¹å®šæ¦‚å¿µå’Œæ•°æ®çš„keyï¼Œä¾‹å¦‚eureka VIPï¼ŒRibbon clientè¿”å›çš„repsonseç­‰ã€‚å®ƒæœ‰ä¸€ä¸ªé™æ€æ–¹æ³•</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// NFRequestContext.java</span>
<span class="token keyword">static</span> <span class="token punctuation">{</span>
    RequestContext<span class="token punctuation">.</span><span class="token function">setContextClass</span><span class="token punctuation">(</span>NFRequestContext<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦åŠ è½½äº†ç±»NFRequestContextï¼Œåº”ç”¨ä¸­æ‰€æœ‰RequestContextçš„å®ä¾‹éƒ½å°†æ˜¯NFRequestContextç±»å‹ã€‚</p>
<h3 id="ZuulRunner"><a href="#ZuulRunner" class="headerlink" title="ZuulRunner"></a>ZuulRunner</h3><p>ZuulServletå¹¶ä¸åšä»»ä½•å®é™…çš„æ“ä½œï¼Œè€Œæ˜¯å°†æ‰€æœ‰æ“ä½œäº¤ç»™ZuulRunnerå®Œæˆã€‚</p>
<p>è€Œäº‹å®ä¸ŠZuulRunnerçš„å¤§éƒ¨åˆ†æ“ä½œä¹Ÿæ˜¯å§”æ‰˜ç»™FilterProcessorå»å®Œæˆçš„ï¼Œé™¤äº†initæ–¹æ³•ã€‚</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// ZuulRunner.java</span>
<span class="token comment" spellcheck="true">/**
 * sets HttpServlet request and HttpResponse
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>HttpServletRequest servletRequest<span class="token punctuation">,</span> HttpServletResponse servletResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RequestContext ctx <span class="token operator">=</span> RequestContext<span class="token punctuation">.</span><span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bufferRequests<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// wrap requestå¹¶ç¼“å­˜å…¶body</span>
        <span class="token comment" spellcheck="true">// æ‰€è°“bufferæ˜¯æŒ‡å°†å…¶å†…å®¹ç¼“å­˜èµ·æ¥ï¼Œä½¿å¾—å¯ä»¥å®‰å…¨åœ°é‡å¤è°ƒç”¨getReader(), getInputStream()ç­‰æ–¹æ³•</span>
        <span class="token comment" spellcheck="true">// å› ä¸ºä¸€èˆ¬æ¥è¯´ï¼Œæµæ“ä½œä¸€æ¬¡ä¹‹åå°±ä¸èƒ½é‡å¤æ“ä½œäº†</span>
        <span class="token comment" spellcheck="true">// ç±»com.netflix.zuul.http.HttpServletRequestWrapperæ³¨é‡Šä¸Šæœ‰è¯¦è§£</span>
        ctx<span class="token punctuation">.</span><span class="token function">setRequest</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpServletRequestWrapper</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span><span class="token function">setRequest</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// responseæ²¡å¾—é€‰ï¼Œè‚¯å®šæ˜¯wrapè¿‡çš„</span>
    ctx<span class="token punctuation">.</span><span class="token function">setResponse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpServletResponseWrapper</span><span class="token punctuation">(</span>servletResponse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="FilterProcessor"><a href="#FilterProcessor" class="headerlink" title="FilterProcessor"></a>FilterProcessor</h3><p>FilterProcessoræ˜¯ä¸ªå•ä¾‹ï¼Œé€šè¿‡getInstance()æ–¹æ³•è·å–ã€‚</p>
<p>FilterProcessorçš„æ ¸å¿ƒæ–¹æ³•æœ‰ä¸¤ä¸ªï¼šrunFilterså’ŒprocessZuulFilter</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// FilterProcessor.java</span>
<span class="token comment" spellcheck="true">/**
 * è¿™ä¸ªæ˜¯çœŸæ­£æ‰§è¡Œfilterçš„æ–¹æ³•ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡éƒ½ä¼šæ‰§è¡ŒåŒä¸€ç±»å‹çš„æ‰€æœ‰filter
 * runs all filters of the filterType sType/ Use this method within filters to run custom filters by type
 *
 * @param sType the filterType.
 * @throws Throwable throws up an arbitrary exception
 */</span>
<span class="token keyword">public</span> Object <span class="token function">runFilters</span><span class="token punctuation">(</span>String sType<span class="token punctuation">)</span> <span class="token keyword">throws</span> Throwable <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// æ·»åŠ debugä¿¡æ¯</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>RequestContext<span class="token punctuation">.</span><span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">debugRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Debug<span class="token punctuation">.</span><span class="token function">addRoutingDebug</span><span class="token punctuation">(</span><span class="token string">"Invoking {"</span> <span class="token operator">+</span> sType <span class="token operator">+</span> <span class="token string">"} type filters"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">boolean</span> bResult <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// é€šè¿‡FilterLoaderè·å–æŒ‡å®šç±»å‹çš„æ‰€æœ‰filter</span>
    List<span class="token operator">&lt;</span>ZuulFilter<span class="token operator">></span> list <span class="token operator">=</span> FilterLoader<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFiltersByType</span><span class="token punctuation">(</span>sType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>list <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è¿™é‡Œæ²¡æœ‰è¿›è¡Œtry...catch... æ„å‘³ç€åªè¦ä»»ä½•ä¸€ä¸ªfilteræ‰§è¡Œå¤±è´¥äº†æ•´ä¸ªè¿‡ç¨‹å°±ä¼šä¸­æ–­æ‰</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ZuulFilter zuulFilter <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object result <span class="token operator">=</span> <span class="token function">processZuulFilter</span><span class="token punctuation">(</span>zuulFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> result <span class="token keyword">instanceof</span> <span class="token class-name">Boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// æ³¨æ„è¿™é‡Œå†™çš„æ˜¯|=ä¸æ˜¯!=</span>
                <span class="token comment" spellcheck="true">// TODO:: ä¸ºä»€ä¹ˆè¦ç”¨è¿™ç§å†™æ³•ï¼Ÿæ—¢ç„¶åªæœ‰resultä¸ºbooleanç±»å‹æ—¶æ‰æ‰§è¡Œï¼Œç›´æ¥èµ‹å€¼ä¸è¡Œå—</span>
                bResult <span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> bResult<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// FilterProcessor.java</span>
<span class="token comment" spellcheck="true">/**
 * æ‰§è¡Œå•ä¸ªzuul filter
 * Processes an individual ZuulFilter. This method adds Debug information. Any uncaught Thowables are caught by this method and converted to a ZuulException with a 500 status code.
 *
 * @param filter
 * @return the return value for that filter
 * @throws ZuulException
 */</span>
<span class="token keyword">public</span> Object <span class="token function">processZuulFilter</span><span class="token punctuation">(</span>ZuulFilter filter<span class="token punctuation">)</span> <span class="token keyword">throws</span> ZuulException <span class="token punctuation">{</span>

    RequestContext ctx <span class="token operator">=</span> RequestContext<span class="token punctuation">.</span><span class="token function">getCurrentContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> bDebug <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">debugRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> String metricPrefix <span class="token operator">=</span> <span class="token string">"zuul.filter-"</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// è¿™ä¸ªå˜é‡æ²¡æœ‰ç”¨åˆ°...</span>
    <span class="token keyword">long</span> execTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    String filterName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> ltime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        filterName <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        RequestContext copy <span class="token operator">=</span> null<span class="token punctuation">;</span>
        Object o <span class="token operator">=</span> null<span class="token punctuation">;</span>
        Throwable t <span class="token operator">=</span> null<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>bDebug<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Debug<span class="token punctuation">.</span><span class="token function">addRoutingDebug</span><span class="token punctuation">(</span><span class="token string">"Filter "</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> filterName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// copyäº†ä¸€ä»½contextç”¨äºdebug</span>
            copy <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        ZuulFilterResult result <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">runFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ExecutionStatus s <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// ç»Ÿè®¡æ‰§è¡Œæ—¶é—´</span>
        execTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> ltime<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// è¿™æ®µå¯¹è¿‡æ»¤å™¨çš„æ‰§è¡ŒçŠ¶æ€è¿›è¡Œè®°å½•</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> FAILED<span class="token operator">:</span>
                t <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ctx<span class="token punctuation">.</span><span class="token function">addFilterExecutionSummary</span><span class="token punctuation">(</span>filterName<span class="token punctuation">,</span> ExecutionStatus<span class="token punctuation">.</span>FAILED<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> execTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> SUCCESS<span class="token operator">:</span>
                o <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ctx<span class="token punctuation">.</span><span class="token function">addFilterExecutionSummary</span><span class="token punctuation">(</span>filterName<span class="token punctuation">,</span> ExecutionStatus<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> execTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>bDebug<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Debug<span class="token punctuation">.</span><span class="token function">addRoutingDebug</span><span class="token punctuation">(</span><span class="token string">"Filter {"</span> <span class="token operator">+</span> filterName <span class="token operator">+</span> <span class="token string">" TYPE:"</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ORDER:"</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"} Execution time = "</span> <span class="token operator">+</span> execTime <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    Debug<span class="token punctuation">.</span><span class="token function">compareContextState</span><span class="token punctuation">(</span>filterName<span class="token punctuation">,</span> copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token keyword">throw</span> t<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// è§¦å‘ä¸€ä¸ªfilter usageå›è°ƒ</span>
        <span class="token comment" spellcheck="true">// å½“å‰notifierçš„å®ç°å›ºå®šæ˜¯BasicFilterUsageNotifierï¼Œé€šè¿‡Servoç»Ÿè®¡filterçš„è°ƒç”¨</span>
        usageNotifier<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> o<span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bDebug<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Debug<span class="token punctuation">.</span><span class="token function">addRoutingDebug</span><span class="token punctuation">(</span><span class="token string">"Running Filter failed "</span> <span class="token operator">+</span> filterName <span class="token operator">+</span> <span class="token string">" type:"</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" order:"</span> <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">filterOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        usageNotifier<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> ExecutionStatus<span class="token punctuation">.</span>FAILED<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">ZuulException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token punctuation">(</span>ZuulException<span class="token punctuation">)</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            ZuulException ex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZuulException</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"Filter threw Exception"</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> filter<span class="token punctuation">.</span><span class="token function">filterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> filterName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœåœ¨line35ä¹‹å‰æŠ›å‡ºäº†å¼‚å¸¸ï¼Œè¿™ä¸ªexecTimeçš„å€¼ä¼šæ˜¯0</span>
            <span class="token comment" spellcheck="true">// ä¸è¿‡ZuulFilter.runFilter()ä¸­åšäº†try...catch...å¤„ç†ï¼Œç†è®ºä¸Šæ¥è¯´ä¸ä¼šå‡ºç°å¼‚å¸¸</span>
            ctx<span class="token punctuation">.</span><span class="token function">addFilterExecutionSummary</span><span class="token punctuation">(</span>filterName<span class="token punctuation">,</span> ExecutionStatus<span class="token punctuation">.</span>FAILED<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> execTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// FilterProcessor.java</span>
<span class="token comment" spellcheck="true">/**
 * Publishes a counter metric for each filter on each use.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BasicFilterUsageNotifier</span> <span class="token keyword">implements</span> <span class="token class-name">FilterUsageNotifier</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String METRIC_PREFIX <span class="token operator">=</span> <span class="token string">"zuul.filter-"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notify</span><span class="token punctuation">(</span>ZuulFilter filter<span class="token punctuation">,</span> ExecutionStatus status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// é€šè¿‡Netflix Servoå¯¹æ¯ä¸ªfilterè¿›è¡Œè°ƒç”¨è®¡æ•°</span>
        DynamicCounter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>METRIC_PREFIX <span class="token operator">+</span> filter<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"status"</span><span class="token punctuation">,</span> status<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"filtertype"</span><span class="token punctuation">,</span> filter<span class="token punctuation">.</span><span class="token function">filterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="StartServer"><a href="#StartServer" class="headerlink" title="StartServer"></a>StartServer</h3><p>StartServeræ˜¯ä¸€ä¸ªServletContextListenerï¼Œè´Ÿè´£åœ¨webåº”ç”¨å¯åŠ¨åæ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œ</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// zuul-netflix-webapp</span>
<span class="token comment" spellcheck="true">// StartServer.java</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// è¿™ä¸ªæ“ä½œæ˜¯è§¦å‘é™æ€å˜é‡AmazonInfoHolder.INFOçš„åˆå§‹åŒ–ï¼Œå¹¶ä¸æ˜¯æ²¡æœ‰æ„ä¹‰çš„</span>
    AmazonInfoHolder<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// ç›‘æ§ã€åº¦é‡ç­‰åˆå§‹åŒ–</span>
    <span class="token function">initPlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// åŠ¨æ€Filterç­‰ç›¸å…³ç±»çš„åˆå§‹åŒ–</span>
    <span class="token function">initZuul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// cassandraåˆå§‹åŒ–</span>
    <span class="token function">initCassandra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// NIWS: Netflix Internal Web Service</span>
    <span class="token comment" spellcheck="true">// ä¸»è¦æ˜¯åˆå§‹åŒ–ribbonçš„å®¢æˆ·ç«¯ä¹‹ç±»çš„</span>
    <span class="token function">initNIWS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// åˆå§‹åŒ–å®Œæˆï¼Œä¿®æ”¹å½“å‰åº”ç”¨å®ä¾‹çš„çŠ¶æ€ä¸ºup</span>
    ApplicationInfoManager<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setInstanceStatus</span><span class="token punctuation">(</span>InstanceInfo<span class="token punctuation">.</span>InstanceStatus<span class="token punctuation">.</span>UP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h4><ul>
<li><a href="filter/dynamic_load.html#FilterLoader">FilterLoaderå·¥ä½œæ–¹å¼</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/source/zuul/debug_env.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/source/zuul/debug_env.html" class="post-title-link" itemprop="url">zuulæºç è§£æ â€”â€” æ­å»ºè°ƒè¯•ç¯å¢ƒ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-29 10:49:29" itemprop="dateCreated datePublished" datetime="2018-11-29T10:49:29+08:00">2018-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/" itemprop="url" rel="index"><span itemprop="name">source</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/zuul/" itemprop="url" rel="index"><span itemprop="name">zuul</span></a>
                </span>
            </span>

          
            <span id="/source/zuul/debug_env.html" class="post-meta-item leancloud_visitors" data-flag-title="zuulæºç è§£æ â€”â€” æ­å»ºè°ƒè¯•ç¯å¢ƒ" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/source/zuul/debug_env.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/source/zuul/debug_env.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h2><blockquote>
<p><a href="https://github.com/Netflix/zuul" target="_blank" rel="noopener">netflix-zuul</a></p>
</blockquote>
<p>å»ºè®®forkä¸€ä»½ï¼Œæ–¹ä¾¿é˜…è¯»æ—¶éšæ‰‹å†™äº›æ³¨é‡Šæäº¤ã€‚</p>
<h2 id="zuulæ¨¡å—ä»‹ç»"><a href="#zuulæ¨¡å—ä»‹ç»" class="headerlink" title="zuulæ¨¡å—ä»‹ç»"></a>zuulæ¨¡å—ä»‹ç»</h2><ul>
<li>zuul-core: ç¡®ç«‹zuulæ•´ä½“æ¶æ„åŠé‡è¦ç±»çš„api</li>
<li>zuul-netflix: æä¾›äº†å¯¹netflixå…¶å®ƒç»„ä»¶çš„é›†æˆç›¸å…³å®ç°ï¼Œå¦‚hystrix, ribbonç­‰ã€‚æ­¤å¤–è¿˜æœ‰ä¸€äº›å·¥å…·ï¼Œå¦‚ç»Ÿè®¡å·¥å…·ã€‚ä¸»è¦æ˜¯ä¸ºzuul-netflix-webappæä¾›æ”¯æŒ</li>
<li>zuul-netflix-webapp: Netflixæä¾›çš„ä¸€ä¸ªå¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„åº”ç”¨å®ç°ï¼ŒåŒ…æ‹¬Filterçš„å…·ä½“å®ç°ï¼Œç›‘æ§ï¼ŒåŠ¨æ€Filterç®¡ç†ç­‰åŠŸèƒ½</li>
<li>zuul-simple-webapp: ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹appï¼ŒåŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰å¤ªå¤§çš„ç ”ç©¶ä»·å€¼</li>
</ul>
<h2 id="è¿è¡Œzuul-simple-webapp"><a href="#è¿è¡Œzuul-simple-webapp" class="headerlink" title="è¿è¡Œzuul-simple-webapp"></a>è¿è¡Œzuul-simple-webapp</h2><p>ç›´æ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> zuul-simple-webapp
$ <span class="token punctuation">..</span>/gradlew jettyRun
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ç„¶åå¯ä»¥é€šè¿‡ <a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a> è®¿é—®<a href="http://localhost:8080" target="_blank" rel="noopener">httpbin</a>ã€‚</p>
<blockquote>
<p>è¯¦ç»†å¯ä»¥å‚è€ƒ<a href="https://github.com/Netflix/zuul/wiki/zuul-simple-webapp" target="_blank" rel="noopener">zuul-simple-webapp</a></p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯httpbin"><a href="#ä»€ä¹ˆæ˜¯httpbin" class="headerlink" title="ä»€ä¹ˆæ˜¯httpbin"></a>ä»€ä¹ˆæ˜¯httpbin</h3><blockquote>
<p>A simple HTTP Request &amp; Response Service</p>
</blockquote>
<p>ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªæ–¹ä¾¿æµ‹è¯•HTTPè¯·æ±‚å’Œå“åº”çš„å„ç§ä¿¡æ¯,æ¯”å¦‚cookie, ip, headerså’Œç™»å½•éªŒè¯ç­‰çš„å·¥å…·ã€‚</p>
<h2 id="è¿è¡Œzuul-netflix-webapp"><a href="#è¿è¡Œzuul-netflix-webapp" class="headerlink" title="è¿è¡Œzuul-netflix-webapp"></a>è¿è¡Œzuul-netflix-webapp</h2><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªå¯ç”¨äºç”Ÿäº§ç¯å¢ƒçš„åº”ç”¨ï¼Œåœ¨å…¶ä¸­é›†æˆäº†eurekaç­‰ï¼Œå› æ­¤éœ€è¦è¿è¡Œèµ·æ¥è¿˜éœ€è¦åšä¸€å®šçš„é…ç½®</p>
<p>é…ç½®zuul.propertiesï¼Œä½äºzuul-netflix-webapp/src/resourcesï¼Œè¿™é‡Œåªåˆ—å‡ºä¸€äº›å¿…é¡»è¦è¦†ç›–çš„é¡¹</p>
<pre class="line-numbers language-properties"><code class="language-properties"><span class="token comment" spellcheck="true"># zuul.properties</span>
<span class="token attr-name">eureka.serviceUrl.default</span><span class="token punctuation">=</span><span class="token attr-value">{ä½ çš„eureka serveræ³¨å†Œåœ°å€}</span>

<span class="token comment" spellcheck="true"># æŒ‡å®šfilterå­˜æ”¾çš„ç›®å½•ï¼Œç”±äºåªæ˜¯è°ƒè¯•ä»£ç ï¼Œç›´æ¥ä½¿ç”¨zuulæä¾›çš„filterå°±å¥½</span>
<span class="token attr-name">zuul.filter.pre.path</span><span class="token punctuation">=</span><span class="token attr-value">src/main/groovy/filters/pre</span>
<span class="token attr-name">zuul.filter.routing.path</span><span class="token punctuation">=</span><span class="token attr-value">src/main/groovy/filters/route</span>
<span class="token attr-name">zuul.filter.post.path</span><span class="token punctuation">=</span><span class="token attr-value">src/main/groovy/filters/post</span>

<span class="token comment" spellcheck="true"># origin clientå¯¹åº”çš„eureka VIP</span>
<span class="token attr-name">origin.zuul.client.DeploymentContextBasedVipAddresses</span><span class="token punctuation">=</span><span class="token attr-value">foo</span>
<span class="token attr-name">origin.zuul.client.Port</span><span class="token punctuation">=</span><span class="token attr-value">8080</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ­¤å¤–ï¼Œå»ºè®®ä¿®æ”¹ä»£ç æ‰“å¼€debugå¼€å…³</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Debug.groovy</span>
<span class="token keyword">boolean</span> <span class="token function">shouldFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åè¿è¡Œ</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> zuul-netflix-webapp
$ <span class="token punctuation">..</span>/gradlew jettyRun
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œæ­¤æ—¶ä½ çš„zuulåº”ç”¨åº”è¯¥å·²ç»æ³¨å†Œåˆ°eureka serverä¸­äº†ã€‚<br>è®¿é—® <a href="http://localhost:8080/healthcheck" target="_blank" rel="noopener">http://localhost:8080/healthcheck</a> ï¼Œå¦‚æœå‡ºç°okï¼Œè¯´æ˜åº”ç”¨å·²è¿è¡ŒæˆåŠŸ<br>è®¿é—® <a href="http://localhost:8080/path" target="_blank" rel="noopener">http://localhost:8080/path</a> å¯ä»¥è·¯ç”±åˆ°ä½ çš„fooæœåŠ¡çš„pathè·¯å¾„ä¸­</p>
<h2 id="debugè¿è¡Œ-IntelliJ-IDEA"><a href="#debugè¿è¡Œ-IntelliJ-IDEA" class="headerlink" title="debugè¿è¡Œ(IntelliJ IDEA)"></a>debugè¿è¡Œ(IntelliJ IDEA)</h2><p>ä¸Šé¢çš„æ“ä½œå¯ä»¥è¿è¡Œzuulçš„webappï¼Œä½†æ˜¯è¿˜æ²¡åŠæ³•è¿›å…¥æ–­ç‚¹è°ƒè¯•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•é…ç½®ç”¨IntelliJ IDEAæ¥è¿›è¡Œæ–­ç‚¹è°ƒè¯•ã€‚</p>
<h3 id="æ·»åŠ gradle-run-debugé…ç½®"><a href="#æ·»åŠ gradle-run-debugé…ç½®" class="headerlink" title="æ·»åŠ gradle run/debugé…ç½®"></a>æ·»åŠ gradle run/debugé…ç½®</h3><p>åœ¨IDEAçš„run/debug configurationsæ·»åŠ ä¸€ä¸ªGradleé…ç½®ï¼Œå‚æ•°å¦‚ä¸‹</p>
<ul>
<li><strong>Gradle project</strong>: zuul-simple-webappæˆ–zuul-netflix-webapp</li>
<li><strong>Tasks</strong>: jettyRun</li>
<li><strong>VM Options</strong>: -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=7777</li>
</ul>
<p>ç„¶åè¿è¡Œï¼Œè¿™æ—¶åº”ç”¨ä¼šè¿›å…¥æ— é™ç­‰å¾…remoteè¿æ¥çš„çŠ¶æ€ï¼Œå› æ­¤éœ€è¦å†æ·»åŠ ä¸€ä¸ªremoteé…ç½®ã€‚</p>
<h3 id="æ·»åŠ remote-run-debugé…ç½®"><a href="#æ·»åŠ remote-run-debugé…ç½®" class="headerlink" title="æ·»åŠ remote run/debugé…ç½®"></a>æ·»åŠ remote run/debugé…ç½®</h3><p>åœ¨IDEAçš„run/debug configrationsæ·»åŠ ä¸€ä¸ªRemoteé…ç½®ï¼Œå‚æ•°å¦‚ä¸‹</p>
<ul>
<li><strong>Host</strong>: localhost</li>
<li><strong>Port</strong>: 7777ï¼ˆå³ä¹‹å‰Gradleé…ç½®ä¸­VM Optionsçš„addressï¼‰</li>
</ul>
<p>ç„¶ådebugè¿è¡Œï¼Œå°±å¯ä»¥æ„‰å¿«åœ°è¿›è¡Œè°ƒè¯•äº†ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/source/zuul/home.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/source/zuul/home.html" class="post-title-link" itemprop="url">zuulæºç è§£æç›®å½•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-28 21:25:22" itemprop="dateCreated datePublished" datetime="2018-11-28T21:25:22+08:00">2018-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/" itemprop="url" rel="index"><span itemprop="name">source</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/source/zuul/" itemprop="url" rel="index"><span itemprop="name">zuul</span></a>
                </span>
            </span>

          
            <span id="/source/zuul/home.html" class="post-meta-item leancloud_visitors" data-flag-title="zuulæºç è§£æç›®å½•" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/source/zuul/home.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/source/zuul/home.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘çœ‹äº†<a href="http://www.iocoder.cn/" target="_blank" rel="noopener">èŠ‹é“</a>çš„<a href="http://www.iocoder.cn/categories/Eureka/" target="_blank" rel="noopener">eurekaæºç è§£æ</a>ã€‚ä¸Šé¢è¿˜æåˆ°äº†ä¸€äº›é˜…è¯»æºç çš„æ–¹æ³•ï¼Œè§‰å¾—æŒºæœ‰æ„æ€çš„ï¼Œå°±æƒ³è‡ªå·±å°è¯•ä¸€ä¸‹ã€‚æ­£å¥½zuulç›¸å¯¹å®Œæ•´ç³»ç»Ÿçš„æºç è§£ææ–‡ç« åœ¨ç½‘ä¸Šè¿˜æ²¡æœ‰ï¼Œè€Œä¸”zuulçš„æºç ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ç¯‡æºç è§£ææ–‡ç« å°±é€‰æ‹©äº†zuulã€‚</p>
<p>æ­¤ç³»åˆ—æ–‡ç« åŸºäº<code>zuul 1.3.0</code>ã€‚</p>
<p>æ­¤ç³»åˆ—æ–‡ç« ä¸spring cloud zuulæ— å…³ï¼Œæ˜¯å¯¹åŸç”Ÿnetflix zuulçš„æºç è§£æã€‚å¯¹äºspring cloud zuulçš„æºç è§£æï¼Œç½‘ä¸Šç›¸å…³çš„æ–‡ç« è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ã€‚</p>
<p>åœ¨Zuulä¸­ï¼Œè¿‡æ»¤å™¨åˆ†ä¸ºå®¹å™¨ï¼ˆjettyï¼‰çš„è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’ŒZuulçš„è¿‡æ»¤å™¨ï¼ˆZuulFilterï¼‰ã€‚ç”±äºåœ¨æˆ‘ä»¬å…³æ³¨çš„æ›´å¤šçš„æ˜¯Zuulçš„è¿‡æ»¤å™¨ï¼Œå› æ­¤åœ¨æ–‡ç« ä¸­å¦‚æ— ç‰¹æ®Šè¯´æ˜ï¼Œæåˆ°è¿‡æ»¤å™¨å‡æŒ‡Zuulçš„è¿‡æ»¤å™¨ã€‚</p>
<h2 id="æ–‡ç« ç›®å½•"><a href="#æ–‡ç« ç›®å½•" class="headerlink" title="æ–‡ç« ç›®å½•"></a>æ–‡ç« ç›®å½•</h2><ul>
<li><a href="debug_env.html">zuulæºç è§£æ â€”â€” æ­å»ºè°ƒè¯•ç¯å¢ƒ</a></li>
<li><a href="architecture.html">zuulæºç è§£æ â€”â€” zuulæ•´ä½“æ¶æ„</a></li>
<li><a href="filters.html">zuulæºç è§£æ â€”â€” è¿‡æ»¤å™¨</a></li>
<li><a href="filters/pre.html">zuulæºç è§£æ â€”â€” Preå’Œå…¶å®ƒç±»å‹çš„è¿‡æ»¤å™¨</a></li>
<li><a href="filters/route.html">zuulæºç è§£æ â€”â€” Routeç±»å‹è¿‡æ»¤å™¨</a></li>
<li><a href="filters/post.html">zuulæºç è§£æ â€”â€” Postç±»å‹è¿‡æ»¤å™¨</a></li>
<li><a href="filter/dynamic_load.html">zuulæºç è§£æ â€”â€” åŠ¨æ€åŠ è½½Filterï¼ˆæœªå®Œæˆï¼‰</a></li>
</ul>
<h2 id="TODO-LIST"><a href="#TODO-LIST" class="headerlink" title="TODO LIST"></a>TODO LIST</h2><p>ä¸ªäººè®°å½•çš„todo listï¼Œè¯·æ— è§†</p>
<ul>
<li style="list-style: none"><input type="checkbox"> monitor, tracerå’Œcounter - éƒ½æ˜¯netflix servoçš„ä¸œè¥¿</li>
<li style="list-style: none"><input type="checkbox" checked> filter registry</li>
<li style="list-style: none"><input type="checkbox"> groovy filter manager: FilterFileManager, FilterLoader</li>
<li style="list-style: none"><input type="checkbox" checked> filter loader</li>
<li style="list-style: none"><input type="checkbox" checked> filter usage notifier</li>
<li style="list-style: none"><input type="checkbox" checked> groovyçš„filterå¦‚ä½•æ‰§è¡Œï¼Ÿ</li>
<li style="list-style: none"><input type="checkbox" checked> zuulçš„é…ç½®ä¸ServletConfig</li>
<li style="list-style: none"><input type="checkbox" checked> zuul servlet, zuul runner, filter processor</li>
<li style="list-style: none"><input type="checkbox" checked> httpbin</li>
<li style="list-style: none"><input type="checkbox" checked> è´¯ä¸²æ•´ä¸ªè¯·æ±‚çš„RequestContext</li>
<li style="list-style: none"><input type="checkbox" checked> pre, route, post, error</li>
<li style="list-style: none"><input type="checkbox"> zuulçš„request wrapperæœ‰ä½•ä¸åŒï¼Ÿ</li>
<li style="list-style: none"><input type="checkbox" checked> zuulå¯¹ä¸€æ¬¡è¯·æ±‚çš„å¤„ç†æµç¨‹</li>
<li style="list-style: none"><input type="checkbox" checked> Debugç±»</li>
<li style="list-style: none"><input type="checkbox" checked> zuulçš„åŠ¨æ€é…ç½®ï¼ˆDynamicPropertyFactoryï¼‰ - å±äºzuul archaiusçš„å†…å®¹</li>
<li style="list-style: none"><input type="checkbox"> zuul event</li>
<li style="list-style: none"><input type="checkbox" checked> vip, routevip, altvipéƒ½æ˜¯äº›å•¥</li>
<li style="list-style: none"><input type="checkbox" checked> RequestContextä¸NFRequextContextåˆ°åº•ç”¨å“ªä¸ªï¼Œæ˜¯åœ¨å“ªé‡Œå†³å®šçš„ï¼Ÿ</li>
<li style="list-style: none"><input type="checkbox"> SurgicalDebugFilter</li>
<li style="list-style: none"><input type="checkbox"> WeightedLoadBalancer</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/UNIX_basic_knowledge.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/UNIX_basic_knowledge.html" class="post-title-link" itemprop="url">UNIXåŸºç¡€çŸ¥è¯†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-30 09:45:57" itemprop="dateCreated datePublished" datetime="2018-09-30T09:45:57+08:00">2018-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UNIX/" itemprop="url" rel="index"><span itemprop="name">UNIX</span></a>
                </span>
            </span>

          
            <span id="/UNIX_basic_knowledge.html" class="post-meta-item leancloud_visitors" data-flag-title="UNIXåŸºç¡€çŸ¥è¯†" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/UNIX_basic_knowledge.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/UNIX_basic_knowledge.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="UNIXåŸºç¡€çŸ¥è¯†"><a href="#UNIXåŸºç¡€çŸ¥è¯†" class="headerlink" title="UNIXåŸºç¡€çŸ¥è¯†"></a>UNIXåŸºç¡€çŸ¥è¯†</h1><h2 id="æ“ä½œç³»ç»Ÿç®€ä»‹"><a href="#æ“ä½œç³»ç»Ÿç®€ä»‹" class="headerlink" title="æ“ä½œç³»ç»Ÿç®€ä»‹"></a>æ“ä½œç³»ç»Ÿç®€ä»‹</h2><p>æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿéƒ½ä¸ºå®ƒä»¬æ‰€è¿è¡Œçš„ç¨‹åºæä¾›æœåŠ¡ï¼ŒåŒ…æ‹¬ï¼šæ‰§è¡Œæ–°ç¨‹åºã€æ‰“å¼€æ–‡ä»¶ã€è¯»å†™æ–‡ä»¶ã€åˆ†é…å­˜å‚¨åŒºç­‰ã€‚</p>
<p>ä¸¥æ ¼æ„ä¹‰ä¸Šè¯´ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿæ˜¯ä¸€ç§è½¯ä»¶ï¼Œå®ƒæ§åˆ¶è®¡ç®—æœºç¡¬ä»¶èµ„æºï¼Œæä¾›ç¨‹åºè¿è¡Œç¯å¢ƒã€‚é€šå¸¸å°†è¿™ç§è½¯ä»¶ç§°ä¸º<code>å†…æ ¸</code>ã€‚å†…æ ¸çš„æ¥å£è¢«ç§°ä¸º<code>ç³»ç»Ÿè°ƒç”¨</code>ï¼Œ<code>å…¬ç”¨å‡½æ•°åº“</code>å»ºç«‹åœ¨ç³»ç»Ÿè°ƒç”¨æ¥å£ä¹‹ä¸Šï¼Œ<code>shell</code>åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šçš„åº”ç”¨ç¨‹åºï¼Œä¸ºå…¶å®ƒåº”ç”¨ç¨‹åºæä¾›æ¥å£ã€‚</p>
<p>Linuxæ˜¯GNUæ“ä½œç³»ç»Ÿä½¿ç”¨çš„å†…æ ¸ã€‚</p>
<p>æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ª<code>å·¥ä½œç›®å½•</code>ï¼Œæ‰€æœ‰çš„ç›¸å¯¹è·¯å¾„éƒ½ä»å·¥ä½œç›®å½•å¼€å§‹è§£é‡Šã€‚</p>
<h2 id="æ–‡ä»¶æè¿°ç¬¦"><a href="#æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦"></a>æ–‡ä»¶æè¿°ç¬¦</h2><p><code>æ–‡ä»¶æè¿°ç¬¦</code>æ˜¯å†…æ ¸ç”¨ä»¥æ ‡è¯†ä¸€ä¸ªç‰¹å®šè¿›ç¨‹æ­£åœ¨è®¿é—®çš„æ–‡ä»¶ï¼Œè¿›ç¨‹è¯»å†™æ–‡ä»¶æ—¶ä½¿ç”¨ã€‚</p>
<p>æ¯è¿è¡Œä¸€ä¸ªæ–°ç¨‹åºæ—¶ï¼Œæ‰€æœ‰çš„shelléƒ½ä¸ºå…¶æ‰“å¼€3ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼š<code>æ ‡å‡†è¾“å…¥0</code>ã€<code>æ ‡å‡†è¾“å‡º1</code>ã€<code>æ ‡å‡†é”™è¯¯2</code>ã€‚å¦‚æœä¸åšç‰¹æ®Šå¤„ç†ï¼Œåˆ™æ‰€è¿™3ä¸ªæè¿°ç¬¦éƒ½å°†é“¾æ¥å‘ç»ˆç«¯ã€‚å¤§å¤šæ•°shelléƒ½æä¾›å°†è¿™3ä¸ªæè¿°ç¬¦é‡å®šå‘çš„æ–¹æ³•ï¼Œå¦‚bash</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token operator">></span> out.txt
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><a href="https://blog.csdn.net/bit_clearoff/article/details/54565044" target="_blank" rel="noopener">å…³äºæ–‡ä»¶æè¿°ç¬¦</a></li>
</ul>
<h2 id="ç¨‹åº"><a href="#ç¨‹åº" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h2><p>ç¨‹åºæ˜¯ä¸€ä¸ªå­˜å‚¨åœ¨ç£ç›˜ä¸ŠæŸä¸ªç›®å½•ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å†…æ ¸ä½¿ç”¨<code>exec</code>å‡½æ•°å°†ç¨‹åºè¯»å…¥å†…å­˜å¹¶æ‰§è¡Œã€‚</p>
<p>ç¨‹åºçš„æ‰§è¡Œå®ä¾‹ç§°ä¸º<code>è¿›ç¨‹</code>ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡ç¬¦ï¼Œç§°ä¸ºè¿›ç¨‹IDã€‚è¿›ç¨‹å¯ä»¥åœ¨å‰å°è¿è¡Œï¼Œå°†è¾“å‡ºæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨åå°è¿è¡Œã€‚å†…æ ¸æ§åˆ¶ç€ç³»ç»Ÿå¦‚ä½•ç®¡ç†è¿è¡Œåœ¨ç³»ç»Ÿä¸Šçš„æ‰€æœ‰è¿›ç¨‹ã€‚</p>
<h2 id="ä¿¡å·"><a href="#ä¿¡å·" class="headerlink" title="ä¿¡å·"></a>ä¿¡å·</h2><p><code>ä¿¡å·</code>ç”¨äºé€šçŸ¥è¿›ç¨‹å‘ç”Ÿäº†æŸç§æƒ…å†µã€‚è¿›ç¨‹æ¥æ”¶åˆ°ä¿¡å·åä¼šè¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p>
<p>å¾ˆå¤šæƒ…å†µéƒ½ä¼šäº§ç”Ÿä¿¡å·ã€‚å¦‚åœ¨ç»ˆç«¯é”®ç›˜ä¸Šå¯ä»¥é€šè¿‡<code>ä¸­æ–­é”®ï¼ˆCtrl-Cï¼‰</code>å’Œ<code>é€€å‡ºé”®ï¼ˆCtrl-\ï¼‰</code>äº§ç”Ÿç›¸åº”çš„ä¿¡æ¯ï¼Œç”¨äºä¸­æ–­å½“å‰è¿è¡Œçš„è¿›ç¨‹ã€‚å¦‚åœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­å¯é€šè¿‡<code>kill</code>å‡½æ•°å‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ä¸­æ–­å…¶è¿è¡Œã€‚</p>
<h2 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h2><h3 id="æ—¥å†æ—¶é—´"><a href="#æ—¥å†æ—¶é—´" class="headerlink" title="æ—¥å†æ—¶é—´"></a>æ—¥å†æ—¶é—´</h3><p>å…¶å€¼ä¸º<code>è‡ªåè°ƒä¸–ç•Œæ—¶ï¼ˆUTCï¼‰</code>ã€‚</p>
<h3 id="è¿›ç¨‹æ—¶é—´"><a href="#è¿›ç¨‹æ—¶é—´" class="headerlink" title="è¿›ç¨‹æ—¶é—´"></a>è¿›ç¨‹æ—¶é—´</h3><p>ä¹Ÿç§°<code>CPUæ—¶é—´</code>ï¼Œç”¨ä»¥åº¦é‡è¿›ç¨‹ä½¿ç”¨çš„ä¸­å¤®å¤„ç†å™¨èµ„æºã€‚æœ‰3ä¸ªè¿›ç¨‹æ—¶é—´å€¼ï¼š</p>
<ul>
<li>æ—¶é’Ÿæ—¶é—´ï¼šè¿›ç¨‹è¿è¡Œçš„æ—¶é—´æ€»é‡</li>
<li>ç”¨æˆ·CPUæ—¶é—´ï¼šæ‰§è¡Œç”¨æˆ·æŒ‡ä»¤æ‰€ç”¨çš„æ—¶é—´é‡</li>
<li>ç³»ç»ŸCPUæ—¶é—´ï¼šä¸ºè¯¥è¿›ç¨‹æ‰§è¡Œå†…æ ¸ç¨‹åºæ‰€ç»å†çš„æ—¶é—´</li>
</ul>
<h2 id="ç³»ç»Ÿè°ƒç”¨å’Œåº“å‡½æ•°"><a href="#ç³»ç»Ÿè°ƒç”¨å’Œåº“å‡½æ•°" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨å’Œåº“å‡½æ•°"></a>ç³»ç»Ÿè°ƒç”¨å’Œåº“å‡½æ•°</h2><p>æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿéƒ½æä¾›å¤šç§æœåŠ¡çš„å…¥å£ç‚¹ï¼Œç”±æ­¤ç¨‹åºå‘å†…æ ¸è¯·æ±‚æœåŠ¡ã€‚è¿™äº›å…¥å£ç‚¹å³ç§°ä¸º<code>ç³»ç»Ÿè°ƒç”¨</code>ã€‚</p>
<p>ç³»ç»Ÿè°ƒç”¨çš„æ¥å£æ˜¯ç”¨cè¯­è¨€å®šä¹‰çš„ï¼Œä¸å…·ä½“ç³»ç»Ÿå¦‚ä½•æ‰§è¡Œè¯¥ç³»ç»Ÿè°ƒç”¨çš„å®ç°æŠ€æœ¯æ— å…³ã€‚</p>
<p><code>é€šç”¨åº“å‡½æ•°</code>å¯èƒ½ä¼šè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå†…æ ¸çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¹Ÿå¯èƒ½ä¸ä¼šï¼Œä½†å®ƒä»¬å¹¶ä¸æ˜¯å†…æ ¸çš„å…¥å£ç‚¹ã€‚ä»å®ç°æ¥çœ‹ï¼Œåº“å‡½æ•°ä¸ç³»ç»Ÿè°ƒç”¨ä¹‹é—´æœ‰ç€æœ¬è´¨åŒºåˆ«ã€‚ä½†ä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œè¿™åŒºåˆ«å¹¶ä¸é‡è¦â€”â€”ç³»ç»Ÿè°ƒç”¨å’Œåº“å‡½æ•°éƒ½æ˜¯ä»¥cå‡½æ•°çš„å½¢å¼å‡ºç°ã€‚</p>
<h2 id="ç³»ç»Ÿå†…å­˜ç®¡ç†"><a href="#ç³»ç»Ÿå†…å­˜ç®¡ç†" class="headerlink" title="ç³»ç»Ÿå†…å­˜ç®¡ç†"></a>ç³»ç»Ÿå†…å­˜ç®¡ç†</h2><p>å†…æ ¸é€šè¿‡ç¡¬ç›˜ä¸Šçš„å­˜å‚¨ç©ºé—´æ¥å®ç°è™šæ‹Ÿå†…å­˜ï¼Œè¿™å—åŒºåŸŸç§°ä¸º<code>äº¤æ¢ç©ºé—´</code>ã€‚å†…æ ¸ä¸æ–­åœ°åœ¨äº¤æ¢ç©ºé—´å’Œå®é™…çš„ç‰©ç†å†…å­˜ä¹‹é—´åå¤äº¤æ¢è™šæ‹Ÿå†…å®¹ä¸­çš„å†…å®¹ï¼Œä½¿å¾—ç³»ç»Ÿä»¥ä¸ºå®ƒæ‹¥æœ‰æ¯”ç‰©ç†å†…å­˜æ›´å¤šçš„å¯ç”¨å†…å­˜ã€‚</p>
<h1 id="UNIXæ ‡å‡†åŠå®ç°"><a href="#UNIXæ ‡å‡†åŠå®ç°" class="headerlink" title="UNIXæ ‡å‡†åŠå®ç°"></a>UNIXæ ‡å‡†åŠå®ç°</h1><h2 id="UNIXæ ‡å‡†"><a href="#UNIXæ ‡å‡†" class="headerlink" title="UNIXæ ‡å‡†"></a>UNIXæ ‡å‡†</h2><ul>
<li>ISO C</li>
<li>IEEE POSIX</li>
<li>SUS(Signle UNIX Spcification)</li>
</ul>
<h2 id="UNIXç³»ç»Ÿçš„å®ç°"><a href="#UNIXç³»ç»Ÿçš„å®ç°" class="headerlink" title="UNIXç³»ç»Ÿçš„å®ç°"></a>UNIXç³»ç»Ÿçš„å®ç°</h2><ul>
<li>SVR4</li>
<li>FreeBSD</li>
<li>Linux</li>
<li>Max OS X</li>
<li>Solaris</li>
</ul>
<p>å…¶ä¸­ï¼Œè™½ç„¶åªæœ‰Max OS Xå’ŒSolarisèƒ½å¤Ÿç§°ä¹‹ä¸ºæ˜¯ä¸€ç§UNIXç³»ç»Ÿï¼Œä½†å®ƒä»¬éƒ½å®ç°äº†UNIXæ ‡å‡†å¹¶æä¾›äº†UNIXçš„ç¼–ç¨‹ç¯å¢ƒã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°.html" class="post-title-link" itemprop="url">ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-28 17:31:32" itemprop="dateCreated datePublished" datetime="2018-09-28T17:31:32+08:00">2018-09-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ‘„å½±/" itemprop="url" rel="index"><span itemprop="name">æ‘„å½±</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ‘„å½±/æ„å›¾/" itemprop="url" rel="index"><span itemprop="name">æ„å›¾</span></a>
                </span>
            </span>

          
            <span id="/ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°.html" class="post-meta-item leancloud_visitors" data-flag-title="ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/ã€Šæ‘„å½±å¸ˆçš„è§†ç•Œã€‹é˜…è¯»ç¬”è®°.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ç”»æ¡†"><a href="#ç”»æ¡†" class="headerlink" title="ç”»æ¡†"></a>ç”»æ¡†</h1><p>å›¾åƒçš„èƒŒæ™¯å³æ˜¯ç”»æ¡†ã€‚</p>
<p>æ•°ç æ‘„å½±ä¹‹å‰ï¼Œæœ€å¸¸è§çš„ç”»é¢åŒºåŸŸæ˜¯<code>3:2</code>çš„æ°´å¹³ç”»æ¡†ã€‚ä¹Ÿæ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ç›¸æœºæ ¼å¼ã€‚ç°åœ¨èƒ¶ç‰‡çš„ç‰©ç†å®½åº¦ä¸å†å—é™åˆ¶ï¼Œ å¤§å¤šæ•°ä¸­ä½ç«¯çš„ç›¸æœºé‡‡ç”¨äº†æ›´çª„æ›´è‡ªç„¶çš„<code>4:3</code>æ ¼å¼ã€‚</p>
<p>æ ¹æ®è¢«æ‘„ä¸»ä½“å’Œæ‘„å½±å¸ˆæ‰€é€‰çš„å¤„ç†æ–¹å¼çš„ä¸åŒï¼Œç”»æ¡†è¾¹ç•Œå¯¹å½±åƒçš„å½±å“å¯ä»¥å¾ˆå¼ºçƒˆï¼Œä¹Ÿå¯ä»¥å¾ˆå¾®å¼±ã€‚</p>
<p>å¯¹è§’çº¿åœ¨ç”»é¢ä¸­ä¸è¾¹ç•Œç”»æ¡†ç›¸å¯¹ç…§ï¼Œèƒ½äº§ç”Ÿå¼ºçƒˆçš„<code>å¯¹è§’å¼ åŠ›</code>ï¼Œä½¿å›¾åƒæ›´å…·åŠ¨æ€ã€‚</p>
<p>æ„å›¾æ—¶éœ€è¦è€ƒè™‘ç”»æ¡†ä¸­æœ‰å‡ ä¸ªä¸»ä½“ï¼Œå¦‚æœæœ‰å¤šä¸ªä¸»ä½“ï¼Œå°±è¦è¿›è¡Œå¹³è¡¡ï¼Œä½¿å¾—ä¸»è¦çš„ä¸»ä½“æ›´çªå‡ºã€‚</p>
<h2 id="ä¸»ä½“å¤§å°"><a href="#ä¸»ä½“å¤§å°" class="headerlink" title="ä¸»ä½“å¤§å°"></a>ä¸»ä½“å¤§å°</h2><p>å¦‚ä½•ä¸ºä¸»ä½“åˆ†é…åœ¨ç…§ç‰‡ä¸­å æ®çš„ç©ºé—´æ¯”ä¾‹ï¼š</p>
<ul>
<li>å¦‚æœä¸»ä½“å¾ˆä¸å¯»å¸¸ã€å¾ˆæœ‰è¶£ï¼Œå¾€å¾€å…¶ç»†èŠ‚æ¯”è¾ƒé‡è¦ï¼Œåº”è¯¥è®©å…¶å æ®æ›´å¤§çš„æ¯”ä¾‹</li>
<li>åä¹‹å°±åº”è¯¥åé€€ä¸€äº›ä½¿æˆ‘ä»¬èƒ½çœ‹åˆ°ä¸€äº›å‘¨å›´çš„ç¯å¢ƒ</li>
</ul>
<h2 id="ä¸»ä½“ä½ç½®"><a href="#ä¸»ä½“ä½ç½®" class="headerlink" title="ä¸»ä½“ä½ç½®"></a>ä¸»ä½“ä½ç½®</h2><p>ä»»ä½•ä¸€å¼ åªæœ‰ä¸€ä¸ªä¸»ä½“çš„ç…§ç‰‡é‡Œï¼Œé™¤éé‡‡ç”¨å°†ç”»æ¡†å¡«æ»¡çš„æ„å›¾æ–¹å¼ï¼Œå¦åˆ™æ€»éœ€è¦å†³å®šæ€ä¹ˆå®‰æ’ä¸»ä½“çš„ä½ç½®ä¸å››å‘¨ç•™ç™½çš„æ¯”ä¾‹ã€‚ä¸€æ—¦å†³å®šåœ¨å››å‘¨ä¿ç•™ç©ºé—´ï¼Œä¸»ä½“çš„ä½ç½®å°±æ˜¯ä¸€ä¸ªå…³é”®ã€‚</p>
<p><strong>é¿å…ä¸­å¤®æ„å›¾</strong>ï¼šç¼ºä¹æƒ³è±¡åŠ›ï¼Œè¿‡äºå•è°ƒä¹å‘³ã€‚ç»å¯¹çš„ä¸­å¿ƒç‚¹å¤ªè¿‡ç¨³å®šï¼Œä½¿ç”»é¢ç¼ºä¹åŠ¨æ„Ÿå¼ åŠ›ã€‚ç•¥å¾®åç¦»ä¸­å¿ƒä¼šä½¿ä¸»ä½“æ›´åŠ èå…¥ç¯å¢ƒã€‚</p>
<p>å¦‚ä½•éœ€è¦é‡‡ç”¨ä¸åŒå¯»å¸¸çš„æ„å›¾ï¼Œé‚£ä¹ˆéœ€è¦æœ‰ä¸€ä¸ªåˆé€‚çš„ç†ç”±ï¼Œå¦åˆ™æ•´ä¸ªå¸ƒå±€å°±æ˜¾å¾—å¾ˆè’è°¬å’Œåå¸¸ã€‚</p>
<h2 id="åˆ†å‰²ç”»æ¡†"><a href="#åˆ†å‰²ç”»æ¡†" class="headerlink" title="åˆ†å‰²ç”»æ¡†"></a>åˆ†å‰²ç”»æ¡†</h2><p>ä»»ä½•ç±»å‹çš„ä»»ä½•å½±åƒéƒ½ä¼šè‡ªåŠ¨åˆ†å‰²ç”»æ¡†ï¼ˆç”šè‡³å¹³æ·¡èƒŒæ™¯ä¸Šçš„ä¸€ä¸ªç»†å°ç‰©ä½“ï¼‰ã€‚</p>
<p>å¦‚æœä»ä¸¤ä¸ªæ–¹å‘åˆ†å‰²ç”»æ¡†ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªäº¤å‰ç‚¹ã€‚è¿™é€šå¸¸æ˜¯ä¸€ä¸ªå®‰æ’è§†è§‰é‡ç‚¹æˆ–å…¶ä»–æ³¨æ„ç‚¹çš„å¥½ä½ç½®ã€‚</p>
<h3 id="åœ°å¹³çº¿"><a href="#åœ°å¹³çº¿" class="headerlink" title="åœ°å¹³çº¿"></a>åœ°å¹³çº¿</h3><p>åœ°å¹³çº¿å¯¹ç”»æ¡†è¿›è¡Œæ¨ªå‘åˆ†å‰²ã€‚</p>
<p>å¦‚æœåœ°å¹³çº¿æ˜¯å”¯ä¸€æœ‰æ„ä¹‰çš„å…ƒç´ ï¼Œé‚£å®ƒçš„ä½ç½®å°±éå¸¸é‡è¦ã€‚</p>
<p>å¦‚æœå…¶å®ƒå…ƒç´ å¯Œæœ‰è¶£å‘³æ€§ï¼Œä¹Ÿå¯ä»¥è®©å…¶å æ®å¤§éƒ¨åˆ†ç”»é¢ï¼Œè€Œä¸éœ€è¦å¤ªè¿‡äºåœ¨æ„åœ°å¹³çº¿çš„ä½ç½®ã€‚</p>
<h3 id="æ¡†ä¸­æ¡†"><a href="#æ¡†ä¸­æ¡†" class="headerlink" title="æ¡†ä¸­æ¡†"></a>æ¡†ä¸­æ¡†</h3><h1 id="è®¾è®¡åŸºç¡€"><a href="#è®¾è®¡åŸºç¡€" class="headerlink" title="è®¾è®¡åŸºç¡€"></a>è®¾è®¡åŸºç¡€</h1><p><strong>æ„å›¾çš„æœ¬è´¨æ˜¯ç»„ç»‡</strong>ï¼Œä½¿ç”»æ¡†é‡Œçš„çš„æœ‰å›¾åƒå…ƒç´ <code>æœ‰åºåŒ–</code>ã€‚è®¾è®¡é‡è¦çš„æ˜¯è¦ç†è§£åŸç†ï¼Œå³ä¸å„äººçš„æ¬£èµå£å‘³æ²¡æœ‰å…³ç³»ï¼Œå¹¶å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæŸäº›ç…§ç‰‡èƒ½ç»™äººç•™ä¸‹æ·±åˆ»å°è±¡ï¼ŒæŸäº›å½±åƒç»„ç»‡æ–¹å¼ä¼šæœ‰æŸç§å¯é¢„è®¡çš„æ•ˆæœã€‚</p>
<p>æ„å›¾ç±»ä¼¼è¯­è¨€ï¼šç”»æ¡†æ˜¯<code>è¯­å¢ƒ</code>ï¼Œè®¾è®¡åŸºç¡€æ˜¯<code>è¯­æ³•</code>ï¼Œå›¾åƒå…ƒç´ æ˜¯<code>è¯æ±‡</code>ï¼Œå…ƒç´ å¤„ç†æ˜¯<code>å¥æ³•</code>ã€‚</p>
<p>æœ€åŸºæœ¬çš„ä¸¤ç§åŸç†ï¼š<code>å¯¹æ¯”</code>å’Œ<code>å¹³è¡¡</code>ã€‚</p>
<p><strong>è®¾è®¡è¿˜å¿…é¡»æ¥å—é™åˆ¶</strong>ï¼šè§‚ä¼—å¯¹æ‘„å½±çš„äº†è§£ã€‚è®¸å¤šè§‚ä¼—ä¹Ÿè®¸å¯¹è®¾è®¡æ‰‹æ³•ä¸€çªä¸é€šï¼Œä½†æ˜¯çœ‹è¿‡å¤§é‡ç…§ç‰‡åä¹Ÿä¼šäº†è§£ä¸€äº›æƒ¯ä¾‹ã€‚æ‰€ä»¥ï¼ŒæŸäº›æ„å›¾æ–¹æ³•å¯ä»¥è¢«çœ‹ä½œæ˜¯å¸¸è§„çš„ï¼Œæ‘„å½±å¸ˆå¯ä»¥æ ¹æ®è‡ªå·±çš„æ„å›¾éµä»æˆ–æŒ‘æˆ˜å®ƒä»¬ã€‚</p>
<h2 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h2><p>å¯¹æ¯”å¼ºè°ƒçš„æ˜¯ç…§ç‰‡ä¸­å›¾åƒå…ƒç´ ä¹‹é—´çš„åŒºåˆ«ï¼ˆ<code>å½±è°ƒ</code>ã€<code>è‰²å½©</code>ã€<code>å½¢æ€</code>ç­‰ï¼‰ï¼Œä¸¤ä¸ªç›¸äº’å¯¹æ¯”çš„å…ƒç´ èƒ½ç›¸äº’åŠ å¼ºã€‚</p>
<h2 id="å¹³è¡¡"><a href="#å¹³è¡¡" class="headerlink" title="å¹³è¡¡"></a>å¹³è¡¡</h2><p>å¹³è¡¡æ˜¯éšå«åœ¨å¯¹æ¯”ä¹‹ä¸­çš„å…³ç³»ï¼Œæ˜¯å¯¹ç«‹å…ƒç´ ä¹‹é—´çš„ä¸»åŠ¨å…³ç³»ã€‚å¹³è¡¡æ˜¯å¼ åŠ›çš„ç»“æœï¼Œæ˜¯å¯¹ç«‹çš„å½±å“åŠ›ç›¸äº’åŒ¹é…ä»¥æä¾›å‡è¡¡å’Œåè°ƒçš„æ„Ÿè§‰ã€‚å¦‚æœå¤±å»å¹³è¡¡ï¼Œå°±ä¼šå¸¦æ¥<code>è§†è§‰å¼ åŠ›</code>ã€‚</p>
<p>è§†è§‰çš„åŸºæœ¬åŸç†æ˜¯<strong>çœ¼ç›æ€»ä¼šè®¾æ³•å¯»æ‰¾æŸç§å¼ åŠ›çš„å¹³è¡¡åŠ›</strong>ã€‚å› æ­¤ï¼Œå¹³è¡¡æ˜¯å’Œè°ï¼Œæ˜¯ç»“æœï¼Œæ˜¯ç›´è§‚æ„Ÿè§‰åˆ°ç¾å­¦æ„‰æ‚¦çš„çŠ¶å†µã€‚</p>
<p>æ— è®ºæˆ‘ä»¬åœ¨è°ˆè®ºçš„æ˜¯å½±è°ƒã€è‰²å½©ã€ç‚¹å¸ƒå±€è¿˜æ˜¯å…¶å®ƒä»€ä¹ˆä¸œè¥¿æ—¶ï¼Œç›®æ ‡éƒ½æ˜¯åœ¨å¯»æ‰¾<code>è§†è§‰çš„ã€é‡å¿ƒã€</code>ã€‚</p>
<p><strong>å¹³è¡¡ç±»å‹</strong></p>
<ul>
<li>é™æ€ï¼ˆå¯¹ç§°ï¼‰å¹³è¡¡ï¼šæ¯æ ·ä¸œè¥¿åˆ°ç…§ç‰‡ä¸­å¿ƒçš„è·ç¦»éƒ½ç›¸ç­‰ï¼Œè¾ƒä¸ºä¸¥è‚ƒã€æ²‰é—·</li>
<li>åŠ¨æ€å¹³è¡¡ï¼šä½¿ç”¨ä¸ç›¸ç­‰çš„é‡é‡å’Œå¼ åŠ›è¾¾æˆå¹³è¡¡ï¼Œæ›´åŠ ç”ŸåŠ¨ã€æ´»æ³¼</li>
</ul>
<p>å¯¹ç§°å¹³è¡¡çš„å¼ åŠ›è¢«å®‰æ’åœ¨å±…ä¸­çš„ä½ç½®ã€‚åŠ¨æ€å¹³è¡¡å¤„ç†çš„åˆ™æ˜¯<strong>ä¸ç›¸ç­‰çš„é‡é‡å’Œå¼ åŠ›</strong>ï¼Œè¿™èƒ½ä½¿å½±åƒæ›´åŠ ç”ŸåŠ¨æ´»æ³¼ã€‚</p>
<p><strong>tip</strong></p>
<ul>
<li>ç›¸æ¯”å¦‚ä½•è¿›è¡Œå¹³è¡¡ï¼Œå…ˆæ¢è®¨<strong>æ˜¯å¦éœ€è¦å¹³è¡¡</strong>å¯èƒ½æ›´é‡è¦ã€‚</li>
</ul>
<h2 id="åŠ¨æ€å¼ åŠ›"><a href="#åŠ¨æ€å¼ åŠ›" class="headerlink" title="åŠ¨æ€å¼ åŠ›"></a>åŠ¨æ€å¼ åŠ›</h2><p>åŠ¨æ€å¼ åŠ›æ˜¯ä½¿ç”¨å„ç§ç»“æ„å†…åœ¨çš„èƒ½åŠ›ï¼Œä»¥ä¿æŒçœ¼ç›çš„è­¦è§‰å¹¶ä½¿ä¹‹ä»ç”»é¢ä¸­å¿ƒ<strong>å‘å¤–å›´ç§»åŠ¨</strong>ã€‚è¿™ä¸æ­£è§„æ„å›¾çš„é™æ€ç‰¹æ€§æ­£å¥½ç›¸åã€‚</p>
<p>å–å¾—åŠ¨æ€å¼ åŠ›çš„æŠ€æœ¯ç›¸å½“ç›´æ¥ï¼šä¸€ç»„å‘ä¸åŒæ–¹å‘çš„æ–œçº¿ã€ç›¸åçš„çº¿æ¡ã€ä»»ä½•å¼•å¯¼çœ¼ç›èµ°å‡ºç”»é¢çš„ç»“æ„æ‰‹æ®µï¼ˆæœ€å¥½æ˜¯ç›¸åæ–¹å‘çš„ï¼‰ã€‚</p>
<h2 id="èŠ‚å¥"><a href="#èŠ‚å¥" class="headerlink" title="èŠ‚å¥"></a>èŠ‚å¥</h2><p>å½“åœºæ™¯ä¸­å‡ºç°ä¸€äº›<strong>ç›¸ä¼¼çš„å…ƒç´ </strong>æ—¶ï¼Œé€šè¿‡å¯¹å®ƒä»¬çš„å¸ƒå±€å¯ä»¥æ„æˆæœ‰èŠ‚å¥çš„è§†è§‰ç»“æ„ã€‚</p>
<p>çœ¼ç›å’Œå¤§è„‘å¤©ç”Ÿç†Ÿç»ƒäºæ‰©å±•æ‰€è§çš„ï¼Œä¼šå¾ˆä¹æ„å‡è®¾<code>èŠ‚å¥çš„å»¶ç»­æ€§</code>ã€‚å› æ­¤ï¼Œæ„ŸçŸ¥åˆ°çš„é‡å¤å½±åƒä¼šæ¯”å®é™…çœ‹åˆ°çš„æ›´é•¿ã€‚</p>
<p>æ‰“ç ´èŠ‚å¥çš„å¼‚å¸¸äº‹ç‰©å¯ä»¥ä½¿å½±å“æ›´å…·åŠ¨æ„Ÿã€‚æœ€å¥½æŠŠè¯¥äº‹ç‰©æ”¾åœ¨å³è¾¹ï¼ˆå› ä¸ºçœ¼ç›é€šå¸¸ä»å·¦å¾€å³è·Ÿè¸ªèŠ‚å¥åŒ–ç»“æ„ï¼Œè¿™æ ·è®©çœ¼ç›æœ‰è¶³å¤Ÿçš„æ—¶é—´å»ºç«‹èŠ‚å¥ï¼‰ã€‚</p>
<h2 id="é€è§†ä¸çºµæ·±"><a href="#é€è§†ä¸çºµæ·±" class="headerlink" title="é€è§†ä¸çºµæ·±"></a>é€è§†ä¸çºµæ·±</h2><p>ã€æ’å¸¸æ¯”ä¾‹ã€ç°è±¡ï¼šä¸¤æ¡å¹³ç­‰çº¿ä»æˆ‘ä»¬èº«è¾¹å»¶ä¼¸ï¼Œä¼šèšåœ¨è¿œæ–¹ï¼Œä½†åŒæ—¶æˆ‘ä»¬å´èƒ½æ„Ÿè§‰åˆ°å®ƒä»¬æ˜¯ç¬”ç›´è€Œå¹³ç­‰çš„ã€‚</p>
<p>çºµæ·±æ„Ÿå¯¹ç…§ç‰‡æ¥è¯´æ€»æ˜¯å¾ˆé‡è¦ã€‚çºµæ·±æ„Ÿå¯ä»¥è¿›ä¸€æ­¥å½±å“ç…§ç‰‡çš„å†™å®æ€§ã€‚</p>
<p>æ‘„å½±å¿…é¡»é‡‡ç”¨å„ç§ç­–ç•¥æ¥åŠ å¼ºæˆ–å‡å¼±ç”»é¢çºµæ·±æ„Ÿã€‚è€Œå½±åƒæœ‰å…¶è‡ªèº«çš„å‚ç…§ç³»ï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„æ„ŸçŸ¥ç³»ã€‚</p>
<h3 id="çº¿å½¢é€è§†"><a href="#çº¿å½¢é€è§†" class="headerlink" title="çº¿å½¢é€è§†"></a>çº¿å½¢é€è§†</h3><p>çº¿å½¢é€è§†çš„ç‰¹ç‚¹æ˜¯ä¼šèšçš„ç›´çº¿ï¼Œè€Œè¿™äº›ç›´çº¿åœ¨å¤§å¤šæ•°åœºæ™¯é‡Œå…¶å®çš„å¹³ç­‰çº¿ã€‚</p>
<p>å¦‚æœç›¸æœºæ˜¯æ°´å¹³çš„ï¼Œè€Œåœºæ™¯æ˜¯é£å…‰ï¼Œé‚£ä¹ˆæ°´å¹³çº¿å°†ä¼šèšåˆ°åœ°å¹³çº¿ã€‚å¦‚æœç›¸æœºå‘ä¸ŠæŒ‡ï¼Œå»ºç­‘è¾¹ç¼˜è¿™æ ·çš„å‚ç›´çº¿å°†ä¼šèšåœ¨å¤©ç©ºä¸­çš„æŸä¸ªç‚¹ã€‚</p>
<h3 id="æ”¶ç¼©é€è§†"><a href="#æ”¶ç¼©é€è§†" class="headerlink" title="æ”¶ç¼©é€è§†"></a>æ”¶ç¼©é€è§†</h3><p>æ”¶ç¼©é€è§†ä¸»è¦å‡ºç°åœ¨ä½äºä¸åŒè·ç¦»çš„å¾ˆå¤šç›¸åŒæˆ–ç›¸ä¼¼çš„ç‰©ä½“ã€‚</p>
<h3 id="ç©ºé—´é€è§†"><a href="#ç©ºé—´é€è§†" class="headerlink" title="ç©ºé—´é€è§†"></a>ç©ºé—´é€è§†</h3><p>å¤§æ°”ç°é›¾é™ä½äº†åœºæ™¯è¿œå¤„éƒ¨åˆ†çš„åå·®ï¼Œæäº®å½±è°ƒã€‚æˆ‘ä»¬çš„çœ¼ç›ä¼šæŠŠè¿™ä½œä¸ºä¸€ä¸ªçºµæ·±çš„æç¤ºã€‚</p>
<h3 id="å½±è°ƒé€è§†"><a href="#å½±è°ƒé€è§†" class="headerlink" title="å½±è°ƒé€è§†"></a>å½±è°ƒé€è§†</h3><p>é»‘è‰²èƒŒæ™¯å‰çš„æ˜äº®ç‰©ä½“é€šå¸¸ç»™äººæ„Ÿè§‰å¾ˆçªå‡ºï¼Œå› æ­¤æœ‰å¾ˆå¼ºçƒˆçš„çºµæ·±æ„Ÿã€‚å¯ä»¥é€šè¿‡å®‰æ’ä¸»ä½“å’Œå…‰çº¿æ¥è¾¾åˆ°å¼ºåŒ–çºµæ·±çš„æ•ˆæœã€‚</p>
<h3 id="è‰²å½©é€è§†"><a href="#è‰²å½©é€è§†" class="headerlink" title="è‰²å½©é€è§†"></a>è‰²å½©é€è§†</h3><p>æš–è‰²è°ƒå…·æœ‰å‰å€¾çš„æ„Ÿè§‰ï¼Œè€Œå†·è‰²è°ƒåˆ™é€€åã€‚</p>
<h3 id="æ¸…æ™°åº¦"><a href="#æ¸…æ™°åº¦" class="headerlink" title="æ¸…æ™°åº¦"></a>æ¸…æ™°åº¦</h3><p>æ¸…æ™°åº¦é«˜å¾€å¾€æš—ç¤ºç€è¿‘è·ç¦»ï¼Œå¯ä»¥é€šè¿‡å¯¹ç„¦æ¥ä½¿ç”»é¢çš„æ¸…æ™°åº¦ä¸åŒï¼Œä»è€Œè¾¾åˆ°å¼ºè°ƒçºµæ·±çš„æ•ˆæœã€‚</p>
<h2 id="å†…å®¹çš„å¼ºä¸å¼±"><a href="#å†…å®¹çš„å¼ºä¸å¼±" class="headerlink" title="å†…å®¹çš„å¼ºä¸å¼±"></a>å†…å®¹çš„å¼ºä¸å¼±</h2><p>æœ‰äº›ç…§ç‰‡æœ¬èº«çš„å†…å®¹å°±éå¸¸å……å®ï¼Œè¿‡åˆ†åœ°è€ƒè™‘æ„å›¾å¯èƒ½é€‚å¾—å…¶åã€‚</p>
<h1 id="å›¾å½¢ä¸æ‘„å½±å…ƒç´ "><a href="#å›¾å½¢ä¸æ‘„å½±å…ƒç´ " class="headerlink" title="å›¾å½¢ä¸æ‘„å½±å…ƒç´ "></a>å›¾å½¢ä¸æ‘„å½±å…ƒç´ </h1><p>æ‰€æœ‰å½¢çŠ¶ä¸­ï¼Œéšéšçº¦çº¦æ„æˆçš„å½¢çŠ¶å¾ˆå‚¨è“„ã€ä¸æƒ¹çœ¼ï¼Œæ˜¯æœ€æœ‰ç”¨çš„ï¼Œèƒ½å¸®åŠ©å°†ä¸€å¹…å½±åƒå½’æ•´æˆå¯è¯†åˆ«çš„å½¢æ€ï¼Œå¹¶é€šè¿‡ç®€å•çš„è§†è§‰æ•ˆæœå¼•å¯¼çœ¼ç›æ»¡æ„åœ°å‘ç°å®ƒä»¬ã€‚</p>
<h2 id="ç‚¹"><a href="#ç‚¹" class="headerlink" title="ç‚¹"></a>ç‚¹</h2><h3 id="å•ç‚¹"><a href="#å•ç‚¹" class="headerlink" title="å•ç‚¹"></a>å•ç‚¹</h3><p>å•ç‚¹å æ®ç”»é¢éå¸¸å°ï¼Œä¸ºäº†é†’ç›®ï¼Œå®ƒå¿…é¡»ä¸ç¯å¢ƒå­˜åœ¨å¯¹æ¯”ã€‚</p>
<h3 id="å¤šç‚¹"><a href="#å¤šç‚¹" class="headerlink" title="å¤šç‚¹"></a>å¤šç‚¹</h3><p>ä¸€æ—¦åŠ å…¥å“ªæ€•ä¸€ä¸ªç‚¹ï¼Œç‚¹ä¹‹é—´çš„è·ç¦»ä¹Ÿä¼šç»™ç”»é¢å¸¦æ¥è·ç¦»æ„Ÿã€‚</p>
<p>ç”»é¢ä¸Šçš„ä¸¤ä¸ªç‚¹ä¼šä½¿è§†çº¿æ¥å›åœ°ä»ä¸€ç‚¹ç§»å‘å¦ä¸€ç‚¹ï¼Œå¯¼è‡´ä¸¤ç‚¹ä¹‹é—´äº§ç”Ÿ<code>éšå«çš„è¿æ¥çº¿</code>ã€‚</p>
<p>ç”»é¢ä¸Šçš„å¤šä¸ªç‚¹åˆ™ä¼šéšå«åœ°è®©äººæ„Ÿè§‰å æ®äº†å®ƒä»¬ä¹‹é—´çš„ç©ºé—´ï¼Œå¯¼è‡´å®ƒä»¬ç»„æˆäº†åŒºåŸŸã€‚</p>
<p>å½“ç”»é¢ä¸Šæœ‰éå¸¸å¤šçš„ç‚¹éœ€è¦å®‰æ’æ—¶ï¼Œå¯ä»¥å°è¯•è‡ªç„¶éšæ„çš„æ„å›¾è€Œéäººä¸ºå®‰æ’ã€‚</p>
<h2 id="çº¿"><a href="#çº¿" class="headerlink" title="çº¿"></a>çº¿</h2><p>å¤§å¤šæ•°çº¿æ¡å®é™…ä¸Šæ˜¯è¾¹ç•Œã€‚</p>
<p><code>å¯¹æ¯”</code>åœ¨å®šä¹‰è§†è§‰çº¿æ¡æ—¶æ‰®æ¼”äº†é‡è¦çš„è§’è‰²ã€‚</p>
<h3 id="æ°´å¹³çº¿"><a href="#æ°´å¹³çº¿" class="headerlink" title="æ°´å¹³çº¿"></a>æ°´å¹³çº¿</h3><h3 id="å‚ç›´çº¿"><a href="#å‚ç›´çº¿" class="headerlink" title="å‚ç›´çº¿"></a>å‚ç›´çº¿</h3><h3 id="æ–œçº¿"><a href="#æ–œçº¿" class="headerlink" title="æ–œçº¿"></a>æ–œçº¿</h3><h3 id="æ›²çº¿"><a href="#æ›²çº¿" class="headerlink" title="æ›²çº¿"></a>æ›²çº¿</h3><h3 id="è§†çº¿"><a href="#è§†çº¿" class="headerlink" title="è§†çº¿"></a>è§†çº¿</h3><h2 id="å½¢çŠ¶"><a href="#å½¢çŠ¶" class="headerlink" title="å½¢çŠ¶"></a>å½¢çŠ¶</h2><h3 id="ä¸‰è§’å½¢"><a href="#ä¸‰è§’å½¢" class="headerlink" title="ä¸‰è§’å½¢"></a>ä¸‰è§’å½¢</h3><p>ä¸‰è§’å½¢æ˜¯æ‘„å½±æ„å›¾ä¸­æœ€æœ‰ç”¨çš„å½¢çŠ¶ï¼Œéƒ¨åˆ†å› ä¸ºå®ƒä»¬æ˜“äºæ„é€ æˆ–æš—ç¤ºï¼Œéƒ¨åˆ†å› ä¸º<code>ä¼šèšæ•ˆæœ</code>ã€‚éšå«ä¸‰è§’å½¢èƒ½ç»™å½±åƒå¸¦æ¥ç§©åºï¼Œéœ€è¦è¿™ç§å®‰æ’çš„åœ°æ–¹é€šå¸¸æ˜¯é‚£äº›<strong>éœ€è¦æ¡ç†æ€§</strong>çš„åœ°æ–¹ã€‚</p>
<p>ä¸‰è§’å½¢å¤©ç”Ÿæ˜¯ä¸€ç§å¼ºçƒˆçš„å½¢çŠ¶ï¼Œéå¸¸å¸å¼•çœ¼ç›ã€‚è€Œä¸”ï¼Œé€šå¸¸åªè¦æœ‰ä¸¤æ¡çº¿å°±å¤Ÿäº†ï¼Œç¬¬ä¸‰æ¡å¯ä»¥å‡è®¾æˆ–è€…ä½¿ç”¨åˆé€‚çš„ç”»æ¡†è¾¹ç•Œã€‚</p>
<p>ç”»æ¡†å†…æ„æˆçš„ä¸‰è§’å½¢åº”å°½é‡å¤§ï¼Œå……æ»¡æ•´ä¸ªç”»é¢ï¼Œèƒ½ä½¿å¾—ç…§ç‰‡çœ‹èµ·æ¥å…·æœ‰<code>ç¨³å®šæ„Ÿ</code>ã€‚</p>
<p><code>å€’ä¸‰è§’</code>åˆ™ç›¸åï¼Œå®ƒæ˜¾å¾—ä¸ç¨³å®šï¼Œæ›´å…·æŒ‘è¡…æ€§ã€‚</p>
<h1 id="ç”¨å…‰çº¿ä¸è‰²å½©æ„å›¾"><a href="#ç”¨å…‰çº¿ä¸è‰²å½©æ„å›¾" class="headerlink" title="ç”¨å…‰çº¿ä¸è‰²å½©æ„å›¾"></a>ç”¨å…‰çº¿ä¸è‰²å½©æ„å›¾</h1><h2 id="æ˜æš—ä¸åŸºè°ƒ"><a href="#æ˜æš—ä¸åŸºè°ƒ" class="headerlink" title="æ˜æš—ä¸åŸºè°ƒ"></a>æ˜æš—ä¸åŸºè°ƒ</h2><p>å¤§å¤šæ•°ç…§ç‰‡çš„ä¿¡æ¯å†…å®¹ä¸»è¦ä½äºä¸­é—´å½±è°ƒã€‚ç„¶è€Œï¼Œ<code>é˜´å½±</code>å’Œ<code>é«˜å…‰</code>èƒ½å¯¹ç…§ç‰‡çš„æƒ…ç»ªçš„æ°”æ°›äº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚</p>
<p>å¦‚æœå¿½ç•¥è‰²å½©ï¼Œå½±è°ƒçš„åˆ†å¸ƒç”±å¯¹æ¯”å’Œäº®åº¦å†³å®šã€‚æŠŠè¿™ä¸¤ä¸ªå› ç´ å½“åšæŒ‡å—ï¼Œå½±åƒçš„é£æ ¼é€‰æ‹©åŸºäºä¸‰ä¸ªæ–¹é¢ï¼šåœºæ™¯çš„ç‰¹å¾ã€åœºæ™¯çš„ç…§æ˜æ–¹å¼ã€æ‘„å½±å¸ˆçš„è¯ é‡Šã€‚</p>
<h2 id="æ„å›¾ä¸­çš„è‰²å½©"><a href="#æ„å›¾ä¸­çš„è‰²å½©" class="headerlink" title="æ„å›¾ä¸­çš„è‰²å½©"></a>æ„å›¾ä¸­çš„è‰²å½©</h2><ul>
<li>è‰²ç›¸ï¼šè‰²ç›¸æ˜¯å„ç§é¢œè‰²ä¹‹æ‰€ä»¥å¾—åçš„ç‰¹æ€§</li>
<li>é¥±å’Œåº¦ï¼šé¥±å’Œåº¦æ˜¯è‰²ç›¸çš„å¯†åº¦æˆ–çº¯åº¦</li>
<li>æ˜äº®åº¦ï¼šæ˜äº®åº¦å†³å®šäº†è‰²ç›¸æ˜¯é»‘æš—çš„è¿˜æ˜¯æ˜äº®çš„</li>
</ul>
<p>å¼ºçƒˆçš„è‰²ç›¸ä»¥å¤šå±‚æ¬¡çš„æ–¹å¼è¢«æ„ŸçŸ¥ï¼Œé™¤äº†å…‰å­¦ç°å®æœ‰å…³ä¹‹å¤–ï¼Œä¹Ÿä¸æ–‡åŒ–å’Œç»å†ç›¸å…³è”ã€‚ä¸åŒçš„é¢œè‰²æœ‰ä¸åŒçš„è±¡å¾æ„ä¹‰ï¼Œåº”æ ¹æ®è¦æ‹æ‘„çš„åœºæ™¯å’Œä¸»é¢˜æ¥é€‰æ‹©ä½¿ç”¨åˆé€‚çš„é¢œè‰²ã€‚</p>
<h3 id="ä¸‰åŸè‰²"><a href="#ä¸‰åŸè‰²" class="headerlink" title="ä¸‰åŸè‰²"></a>ä¸‰åŸè‰²</h3><ul>
<li>çº¢è‰²è¢«è®¤ä¸ºæ˜¯æœ€å¼ºçƒˆã€å¯†åº¦æœ€é«˜çš„é¢œè‰²ï¼Œå…·æœ‰å‰è¿›çš„å€¾å‘ï¼Œå¯ä»¥å¼ºåŒ–çºµæ·±æ„Ÿã€‚å®ƒå……æ»¡æ´»åŠ›ã€ç”Ÿæœºã€å¼ºçƒˆã€æ¸©æš–ã€ç‚çƒ­ï¼Œæš—ç¤ºæ¿€æƒ…ã€ä¾µç•¥å’Œå±é™©ã€‚</li>
<li>é»„è‰²æ˜¯æ‰€æœ‰é¢œè‰²ä¸­æœ€æ˜äº®çš„ï¼Œç”šè‡³æ²¡æœ‰é»‘æš—çš„å½¢å¼ã€‚å®ƒç²¾åŠ›å……æ²›ã€é”åˆ©ã€åšå®šã€å¥½æ–—ã€æ¬¢ä¹ï¼Œèƒ½ä¸å¤ªé˜³ä»¥åŠå…¶ä»–å…‰æºç›¸å…³è”ã€‚</li>
<li>è“è‰²æ¯”é»„è‰²æ”¶æ•›ï¼Œå€¾å‘äºå®‰é™ï¼Œç›¸å¯¹è¾ƒæš—ï¼Œæ˜¾å¾—å†·é™ã€‚è“è‰²è¾ƒé€æ˜ï¼Œæœ‰å¾ˆå¤šå½¢å¼ï¼Œå¾ˆå¤šäººéš¾ä»¥ç²¾ç¡®åˆ¤æ–­ã€‚</li>
</ul>
<h3 id="ä¸‰è¡¥è‰²"><a href="#ä¸‰è¡¥è‰²" class="headerlink" title="ä¸‰è¡¥è‰²"></a>ä¸‰è¡¥è‰²</h3><ul>
<li>ç»¿è‰²é€šå¸¸æ˜¯æ­£é¢çš„ï¼Œè±¡å¾ç”Ÿé•¿ã€å¸Œæœ›å’Œè¿›æ­¥ã€‚ç»¿è‰²çš„è´Ÿé¢å…³è”åˆ™æ˜¯ç–¾ç—…å’Œè…çƒ‚ã€‚</li>
<li>ç´«è‰²æ˜¯éš¾ä»¥æ‰æ‘¸çš„ã€ç¨€æœ‰çš„é¢œè‰²ã€‚éš¾ä»¥å¯»æ‰¾ã€æ•æ‰ï¼Œä¹Ÿéš¾ä»¥ç²¾ç¡®å†ç°ã€‚ç´«è‰²æ˜¯å¯Œæœ‰ã€å¥¢ä¾ˆã€ç¥ç§˜ã€æµ©ç€šçš„è±¡å¾ã€‚</li>
<li>æ©™è‰²æ¸©æš–ã€å¼ºçƒˆã€è¾‰ç…Œã€æœ‰åŠ›ï¼Œä¹Ÿä»£è¡¨ç‚çƒ­å’Œå¹²ç‡¥ã€‚</li>
</ul>
<h2 id="è‰²å½©å…³ç³»"><a href="#è‰²å½©å…³ç³»" class="headerlink" title="è‰²å½©å…³ç³»"></a>è‰²å½©å…³ç³»</h2><p>è‰²å½©å¿…é¡»æŒ‰å½¼æ­¤ä¹‹é—´çš„å…³ç³»æ¥å¤„ç†ã€‚è§†è§‰ç›¸é‚»çš„è‰²å½©ä¸åŒï¼Œå®ƒä»¬çš„æ„Ÿå—ä¹Ÿä¸åŒã€‚</p>
<h3 id="è‰²å½©ç»„åˆ"><a href="#è‰²å½©ç»„åˆ" class="headerlink" title="è‰²å½©ç»„åˆ"></a>è‰²å½©ç»„åˆ</h3><p>ä¸¤ç§å’Œè°å…³ç³»ï¼š</p>
<ul>
<li>äº’è¡¥è‰²å’Œè°</li>
<li>ç›¸ä¼¼è‰²å’Œè°</li>
</ul>
<p>ä¸åŒçš„è‰²å½©è¢«äººä»¬æ„Ÿå—åˆ°çš„äº®åº¦å€¼æ˜¯ä¸åŒçš„ã€‚ä¾‹å¦‚ï¼Œé»„è‰²æœ€äº®ï¼Œç´«è‰²æœ€æš—ã€‚</p>
<h3 id="è‰²å½©é‡ç‚¹"><a href="#è‰²å½©é‡ç‚¹" class="headerlink" title="è‰²å½©é‡ç‚¹"></a>è‰²å½©é‡ç‚¹</h3><p>ä¸€å°å—å¯¹æ¯”è‰²å…·æœ‰èšç„¦çš„æ•ˆæœã€‚æœ€æ˜æ˜¾çš„æ•ˆæœæ˜¯å½“ç¯å¢ƒæ˜¯ç›¸å¯¹æ°´è‰²çš„ï¼Œè€Œçº¯è‰²ç›¸å æ®äº†å±€éƒ¨åŒºåŸŸã€‚è¿™ç§ç‰¹åˆ«å½¢å¼çš„è‰²å½©å¯¹æ¯”æ— å¯é¿å…åœ°ä¼šæ˜¾å¾—æ›´ä¸ºçªå‡ºï¼Œç§°ä¹‹ä¸º<code>åœ°æ–¹è‰²å½©</code>ã€‚</p>
<h2 id="æ¸©å’Œçš„è‰²å½©"><a href="#æ¸©å’Œçš„è‰²å½©" class="headerlink" title="æ¸©å’Œçš„è‰²å½©"></a>æ¸©å’Œçš„è‰²å½©</h2><p>é™¤éåœ¨äººé€ çš„ç¯å¢ƒï¼Œå¼ºçƒˆçš„è‰²å½©åœ¨è‡ªç„¶ä¸–ç•Œä¸Šç›¸å¯¹ç¨€å°‘ã€‚</p>
<p>æ¸©å’Œè‰²å½©æ›´ç»†å¾®ï¼Œæä¾›æ›´å®‰é™ç”šè‡³æ›´ä¼˜é›…çš„æ„‰æ‚¦ã€‚</p>
<h2 id="é»‘ç™½"><a href="#é»‘ç™½" class="headerlink" title="é»‘ç™½"></a>é»‘ç™½</h2><p>é»‘å’Œç™½æ›´èƒ½å…¨é¢åœ°è¡¨ç°å½±è°ƒå˜åŒ–ã€è´¨æ„Ÿå†ç°ã€å½¢å¼æ¨¡å‹å’Œå®šä¹‰å½¢çŠ¶ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/redissonå­¦ä¹ ç¬”è®°.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/redissonå­¦ä¹ ç¬”è®°.html" class="post-title-link" itemprop="url">redissonå­¦ä¹ ç¬”è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-09-21 13:57:48" itemprop="dateCreated datePublished" datetime="2018-09-21T13:57:48+08:00">2018-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/redisson/" itemprop="url" rel="index"><span itemprop="name">redisson</span></a>
                </span>
            </span>

          
            <span id="/redissonå­¦ä¹ ç¬”è®°.html" class="post-meta-item leancloud_visitors" data-flag-title="redissonå­¦ä¹ ç¬”è®°" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/redissonå­¦ä¹ ç¬”è®°.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/redissonå­¦ä¹ ç¬”è®°.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="è®¤è¯†redisson"><a href="#è®¤è¯†redisson" class="headerlink" title="è®¤è¯†redisson"></a>è®¤è¯†redisson</h1><p>æ¥çœ‹ä¸‹å®˜æ–¹çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>Redis based In-Memory Data Grid for Java. State of the Art Redis client.</p>
</blockquote>
<p>å¯ä»¥çŸ¥é“ï¼Œredissonæ˜¯Javaçš„ä¸€æ¬¾rediså®¢æˆ·ç«¯ã€‚</p>
<p>ä½œä¸ºrediså®¢æˆ·ç«¯ï¼Œå®ƒå’Œå¤§åé¼é¼çš„<code>jedis</code>æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿredissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹redisçš„<strong>å…³æ³¨åˆ†ç¦»</strong>ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œredissonå¯¹redisçš„æ“ä½œè¿›è¡Œäº†ä¸€äº›æ›´é«˜çº§çš„æŠ½è±¡ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åœ°å®ç°ä¸€äº›å¤æ‚çš„åŠŸèƒ½ï¼Œå¦‚ä¸€ç³»åˆ—çš„<code>Javaåˆ†å¸ƒå¼å¯¹è±¡</code>ï¼Œå¸¸ç”¨çš„<code>åˆ†å¸ƒå¼æœåŠ¡</code>ç­‰ã€‚è€Œä½œä¸ºæŠ½è±¡çš„ä»£ä»·ï¼Œå°±æ˜¯ä¸¢å¤±äº†å¯¹åº•å±‚ç»†èŠ‚çš„æŒæ§ã€‚</p>
<h1 id="Getting-Start"><a href="#Getting-Start" class="headerlink" title="Getting Start"></a>Getting Start</h1><p>redissonå®˜æ–¹å°±æ”¯æŒä¸spring-booté›†æˆï¼Œå› æ­¤æ ¹æ®<a href="https://github.com/redisson/redisson/tree/master/redisson-spring-boot-starter" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ç›´æ¥ä¾èµ–</p>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>redisson-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å†é…ç½®ç›¸å…³yamlï¼Œä»¥æœ€ç®€å•çš„æœ¬åœ°å•æœºæ¨¡å¼å¯åŠ¨</p>
<p><strong>application.yaml</strong></p>
<pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">redisson</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>redisson.yaml
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>redisson.yaml</strong></p>
<pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">singleServerConfig</span><span class="token punctuation">:</span>
  <span class="token key atrule">address</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span><span class="token number">6379</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ç„¶è€Œæ·»åŠ ä¾èµ–åç›´æ¥å¯åŠ¨spring bootåº”ç”¨å±…ç„¶æŠ¥é”™äº†ï¼Œæ³¨å…¥<code>RedissonClient</code>å¤±è´¥ï¼</p>
<p>å¦ˆè€¶ï¼ŒGoogleäº†ä¸€ä¸‹æ— æœï¼Œç›´æ¥çœ‹æºç ï¼Œå±…ç„¶å‘ä¸‹<code>redisson-spring-boot-starter</code>è¿™ä¸ªåŒ…æ²¡æœ‰<code>spring.factories</code>æ–‡ä»¶ï¼Œä¹Ÿå³æ˜¯è¯´<code>RedissonAutoConfiguration</code>ä¸ä¼šè‡ªåŠ¨åŠ è½½ã€‚ã€‚</p>
<p>äºæ˜¯è¡¥ä¸Š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@ImportAutoConfiguration</span><span class="token punctuation">(</span>RedissonAutoConfiguration<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è™½ç„¶ä¸çŸ¥é“redissonå®˜æ–¹å‡ºäºä»€ä¹ˆåŸå› æ²¡æœ‰æä¾›<code>spring.factories</code>æ–‡ä»¶ï¼Œæ€»ä¹‹å†æ¬¡å¯åŠ¨ï¼Œæ­£å¸¸ã€‚</p>
<h1 id="redissoné”"><a href="#redissoné”" class="headerlink" title="redissoné”"></a>redissoné”</h1><h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><h3 id="æ¥å£è°ƒç”¨é™åˆ¶"><a href="#æ¥å£è°ƒç”¨é™åˆ¶" class="headerlink" title="æ¥å£è°ƒç”¨é™åˆ¶"></a>æ¥å£è°ƒç”¨é™åˆ¶</h3><h1 id="redissonæ‰§è¡Œluaè„šæœ¬"><a href="#redissonæ‰§è¡Œluaè„šæœ¬" class="headerlink" title="redissonæ‰§è¡Œluaè„šæœ¬"></a>redissonæ‰§è¡Œluaè„šæœ¬</h1><p>redissonæä¾›äº†å¾ˆæ–¹ä¾¿åœ°æ‰§è¡Œluaè„šæœ¬çš„æ–¹å¼</p>
<pre class="line-numbers language-java"><code class="language-java">redissonClient<span class="token punctuation">.</span><span class="token function">getScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>
    RScript<span class="token punctuation">.</span>Mode<span class="token punctuation">.</span>READ_ONLY<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//æ‰§è¡Œæ¨¡å¼</span>
    <span class="token string">"return redis.call('get', KEYS[1])"</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// è¦æ‰§è¡Œçš„luaè„šæœ¬</span>
    RScript<span class="token punctuation">.</span>ReturnType<span class="token punctuation">.</span>INTEGER<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¿”å›å€¼ç±»å‹</span>
    Lists<span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token string">"tac"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ä¼ å…¥KEYS</span>
    <span class="token boolean">true</span><span class="token punctuation">,</span> 1L<span class="token punctuation">,</span> <span class="token string">"hello"</span>   <span class="token comment" spellcheck="true">//ä¼ å…¥ARGV</span>
<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æ›´å…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£<a href="https://github.com/redisson/redisson/wiki/10.-%E9%A2%9D%E5%A4%96%E5%8A%9F%E8%83%BD#104-%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C" target="_blank" rel="noopener">è„šæœ¬æ‰§è¡Œ</a></p>
</blockquote>
<h2 id="è¸©è¿‡çš„ä¸€äº›å‘"><a href="#è¸©è¿‡çš„ä¸€äº›å‘" class="headerlink" title="è¸©è¿‡çš„ä¸€äº›å‘"></a>è¸©è¿‡çš„ä¸€äº›å‘</h2><h3 id="ä¼ å…¥çš„Booleanå€¼å‚æ•°ä¼šå˜æˆå­—ç¬¦ä¸²"><a href="#ä¼ å…¥çš„Booleanå€¼å‚æ•°ä¼šå˜æˆå­—ç¬¦ä¸²" class="headerlink" title="ä¼ å…¥çš„Booleanå€¼å‚æ•°ä¼šå˜æˆå­—ç¬¦ä¸²"></a>ä¼ å…¥çš„Booleanå€¼å‚æ•°ä¼šå˜æˆå­—ç¬¦ä¸²</h3><p>å‡è®¾é€šè¿‡redissonçš„eval()ä¼ å…¥çš„<code>ARGV = false</code>ï¼Œé‚£ä¹ˆåœ¨luaè„šæœ¬ä¸­</p>
<pre class="line-numbers language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">--è¾“å‡º'string'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ä¼ å…¥æ•°å€¼ä¹Ÿä¼šå˜æˆå­—ç¬¦ä¸²ï¼Œéintå‹åˆ™ä¼šè¢«åºåˆ—åŒ–å­˜å‚¨"><a href="#ä¼ å…¥æ•°å€¼ä¹Ÿä¼šå˜æˆå­—ç¬¦ä¸²ï¼Œéintå‹åˆ™ä¼šè¢«åºåˆ—åŒ–å­˜å‚¨" class="headerlink" title="ä¼ å…¥æ•°å€¼ä¹Ÿä¼šå˜æˆå­—ç¬¦ä¸²ï¼Œéintå‹åˆ™ä¼šè¢«åºåˆ—åŒ–å­˜å‚¨"></a>ä¼ å…¥æ•°å€¼ä¹Ÿä¼šå˜æˆå­—ç¬¦ä¸²ï¼Œéintå‹åˆ™ä¼šè¢«åºåˆ—åŒ–å­˜å‚¨</h3><p>å‡è®¾é€šè¿‡redissonçš„eval()ä¼ å…¥çš„<code>ARGV = 1L</code>ï¼Œé‚£ä¹ˆåœ¨luaè„šæœ¬ä¸­è·å–ä¼šå˜æˆ</p>
<pre class="line-numbers language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">--è¾“å‡º'["java.lang.Long",1]'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è‹¥ä¼ å…¥çš„æ˜¯<code>ARGV = 1</code>ï¼Œåˆ™</p>
<pre class="line-numbers language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true">--è¾“å‡º'1'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ç›´æ¥ä»redis-call-è·å–å¾—å€¼æ˜¯intå‹ï¼Œè€Œåœ¨luaä¸­è¿›è¡Œäº†æ•°å€¼æ“ä½œåå¾—åˆ°çš„å€¼å´æ˜¯longå‹"><a href="#ç›´æ¥ä»redis-call-è·å–å¾—å€¼æ˜¯intå‹ï¼Œè€Œåœ¨luaä¸­è¿›è¡Œäº†æ•°å€¼æ“ä½œåå¾—åˆ°çš„å€¼å´æ˜¯longå‹" class="headerlink" title="ç›´æ¥ä»redis.call()è·å–å¾—å€¼æ˜¯intå‹ï¼Œè€Œåœ¨luaä¸­è¿›è¡Œäº†æ•°å€¼æ“ä½œåå¾—åˆ°çš„å€¼å´æ˜¯longå‹"></a>ç›´æ¥ä»redis.call()è·å–å¾—å€¼æ˜¯intå‹ï¼Œè€Œåœ¨luaä¸­è¿›è¡Œäº†æ•°å€¼æ“ä½œåå¾—åˆ°çš„å€¼å´æ˜¯longå‹</h3><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç»“æœæ˜¯è½¬æ¢ä¸º<code>java.lang.Integer</code></p>
<pre class="line-numbers language-lua"><code class="language-lua"><span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'tac'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è€Œä»¥ä¸‹ç»“æœå´æ˜¯è½¬æ¢ä¸º<code>java.lang.Long</code></p>
<pre class="line-numbers language-lua"><code class="language-lua"><span class="token keyword">local</span> tac <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'tac'</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> tac <span class="token operator">+</span> <span class="token number">1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="ä¸€äº›å°ç»†èŠ‚"><a href="#ä¸€äº›å°ç»†èŠ‚" class="headerlink" title="ä¸€äº›å°ç»†èŠ‚"></a>ä¸€äº›å°ç»†èŠ‚</h1><ul>
<li>æ³¨æ„æ˜¯redissonï¼Œä¸è¦å†™æˆredission</li>
<li>redissonæä¾›çš„æ‰€æœ‰ç±»éƒ½æ˜¯ä»¥Rå¼€å¤´çš„ï¼Œå¦‚RLock</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/zuul_hystrix_default_timeout_config_invalid_reason_research.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zuul_hystrix_default_timeout_config_invalid_reason_research.html" class="post-title-link" itemprop="url">zuulä¸­hystrixé»˜è®¤timeouté…ç½®å¤±æ•ˆçš„åŸå› </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-08-30 15:29:35" itemprop="dateCreated datePublished" datetime="2018-08-30T15:29:35+08:00">2018-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/è¸©å‘æ—¥è®°/" itemprop="url" rel="index"><span itemprop="name">è¸©å‘æ—¥è®°</span></a>
                </span>
            </span>

          
            <span id="/zuul_hystrix_default_timeout_config_invalid_reason_research.html" class="post-meta-item leancloud_visitors" data-flag-title="zuulä¸­hystrixé»˜è®¤timeouté…ç½®å¤±æ•ˆçš„åŸå› " title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/zuul_hystrix_default_timeout_config_invalid_reason_research.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/zuul_hystrix_default_timeout_config_invalid_reason_research.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æ‰€å¤„ç¯å¢ƒ"><a href="#æ‰€å¤„ç¯å¢ƒ" class="headerlink" title="æ‰€å¤„ç¯å¢ƒ"></a>æ‰€å¤„ç¯å¢ƒ</h1><ul>
<li><code>spring boot</code>: 1.5.9.RELEASE</li>
<li><code>spring cloud</code>: Edgware.RELEASE</li>
</ul>
<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>æ ¹æ®netflix hystrixå®˜æ–¹çš„æè¿°ï¼Œå¯ä»¥é€šè¿‡<a href="https://github.com/Netflix/Hystrix/wiki/Configuration#execution.isolation.thread.timeoutInMilliseconds" target="_blank" rel="noopener"><code>hystrix.command.default.execution.isolation.thread.timeoutInMilliseconds</code></a>è¿™ä¸ªå…¨å±€é…ç½®ä¸ºæ‰€æœ‰æœåŠ¡é…ç½®é»˜è®¤è¶…æ—¶æ—¶é—´ã€‚ç„¶è€Œåœ¨å®è·µä¸­å´å‘ç°è¯¥é…ç½®å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼ˆä¸€ç›´æ˜¯2000msï¼‰ï¼Œä½†é’ˆå¯¹å„æœåŠ¡è¿›è¡Œå•ç‹¬é…ç½®å´æ˜¯å¯ä»¥ç”Ÿæ•ˆçš„ã€‚</p>
<h1 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h1><p>ç»googleå‘ç°ï¼Œhystrixçš„timeoutæœºåˆ¶æ˜¯é€šè¿‡<code>HystrixTimer</code>æ¥å¤„ç†çš„ã€‚</p>
<p>HystrixTimeræ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨æ‰§è¡Œ<code>HystrixCommand</code>å‰é€šè¿‡è°ƒç”¨HystrixTimer.getInstance().addTimerListener()æ–¹æ³•æ¥æ·»åŠ ä¸€ä¸ªå®šæ—¶çš„listenerï¼Œç„¶ååœ¨command on completedçš„æ—¶å€™ç§»é™¤å®ƒã€‚ç›¸å…³çš„ä»£ç å·²ç»ç”±netflixå®ç°äº†ï¼Œå¯ä»¥æŸ¥çœ‹æºç <a href="https://github.com/Netflix/Hystrix/blob/master/hystrix-core/src/main/java/com/netflix/hystrix/AbstractCommand.java#L1137" target="_blank" rel="noopener"><code>AbstractCommand.java</code></a></p>
<pre class="line-numbers language-java"><code class="language-java">TimerListener listener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TimerListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIntervalTimeInMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> originalCommand<span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">executionTimeoutInMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> Reference<span class="token operator">&lt;</span>TimerListener<span class="token operator">></span> tl <span class="token operator">=</span> HystrixTimer<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTimerListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// set externally so execute/queue can see this</span>
originalCommand<span class="token punctuation">.</span>timeoutTimer<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>tl<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
* If this subscriber receives values it means the parent succeeded/completed
*/</span>
Subscriber<span class="token operator">&lt;</span>R<span class="token operator">></span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token operator">&lt;</span>R<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNotTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// stop timer and pass notification through</span>
            tl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            child<span class="token punctuation">.</span><span class="token function">onCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span>Throwable e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNotTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// stop timer and pass notification through</span>
            tl<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            child<span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»ä»¥ä¸Šä»£ç å¯ä»¥å¾ˆå®¹æ˜“è¿½æº¯åˆ°hystrixè¶…æ—¶æ—¶é—´æ˜¯ä»originalCommand.properties(<code>HystrixCommandProperties</code>)è¿™ä¸ªå¯¹è±¡ä¸­è·å–çš„ï¼Œè€Œåœ¨spring cloudæä¾›çš„<code>AbstractRibbonCommand</code>ä¸­å­˜åœ¨ä»¥ä¸‹ä»£ç </p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">final</span> HystrixCommandProperties<span class="token punctuation">.</span>Setter setter <span class="token operator">=</span> HystrixCommandProperties<span class="token punctuation">.</span><span class="token function">Setter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withExecutionIsolationStrategy</span><span class="token punctuation">(</span>zuulProperties<span class="token punctuation">.</span><span class="token function">getRibbonIsolationStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withExecutionTimeoutInMilliseconds</span><span class="token punctuation">(</span>
                RibbonClientConfiguration<span class="token punctuation">.</span>DEFAULT_CONNECT_TIMEOUT <span class="token operator">+</span> RibbonClientConfiguration<span class="token punctuation">.</span>DEFAULT_READ_TIMEOUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>å¯¼è‡´originalCommand.propertiesåœ¨æ„å»ºæ—¶å¯ä»¥è·å–åˆ°ä¸€ä¸ªexecutionTimeoutInMillisecondsçš„å®ä¾‹çº§é»˜è®¤å€¼ï¼Œä»è€Œè¦†ç›–æ‰äº†å…¨å±€çš„executionTimeoutInMillisecondsé…ç½®ï¼Œä½†å®ä¾‹çº§çš„é…ç½®å¹¶ä¸å—å½±å“ï¼Œå› ä¸ºhystrix propertyä¼˜å…ˆçº§ä¸ºï¼š</strong>  </p>
<ol>
<li>Global default from code</li>
<li>Dynamic global default property</li>
<li>Instance default from code</li>
<li>Dynamic instance property</li>
</ol>
<h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><ol>
<li><p>æ”¹å†™HttpClientRibbonCommandçš„å®ç°<br>//todo:: å¾…è¡¥å……</p>
</li>
<li><p>å‡çº§spring cloudç‰ˆæœ¬åˆ°Edgware.SR1ä»¥ä¸Š<br>Spring cloudåœ¨<code>Edgware.SR1</code>ç‰ˆæœ¬ä¸­å·²ç»è§£å†³äº†æ­¤é—®é¢˜(<a href="https://github.com/spring-cloud/spring-cloud-netflix/pull/2633" target="_blank" rel="noopener">issue2633</a>)ï¼Œå¦‚æœæœ‰æ¡ä»¶å¯ä»¥ç›´æ¥é€šè¿‡å‡çº§ç‰ˆæœ¬æ¥è§£å†³æ­¤é—®é¢˜ã€‚</p>
</li>
</ol>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul>
<li><a href="https://github.com/Netflix/Hystrix/wiki/Configuration" target="_blank" rel="noopener">Hystrix Configurations</a></li>
<li><a href="https://segmentfault.com/a/1190000015393836" target="_blank" rel="noopener">èŠèŠhystrixçš„timeoutå¤„ç† - segmentfault</a></li>
<li><a href="https://segmentfault.com/a/1190000012439580" target="_blank" rel="noopener">Hystrixå·¥ä½œåŸç†</a></li>
<li><a href="https://www.jianshu.com/p/6e2f11821c77" target="_blank" rel="noopener">ribbonè®¾ç½®urlçº§åˆ«çš„è¶…æ—¶æ—¶é—´</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/openfeign_research_and_application.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/openfeign_research_and_application.html" class="post-title-link" itemprop="url">å£°æ˜å¼httpå®¢æˆ·ç«¯openfeignçš„ç ”ç©¶ä¸åº”ç”¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-06-21 05:54:42" itemprop="dateCreated datePublished" datetime="2018-06-21T05:54:42+08:00">2018-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/spring-cloud/" itemprop="url" rel="index"><span itemprop="name">spring cloud</span></a>
                </span>
            </span>

          
            <span id="/openfeign_research_and_application.html" class="post-meta-item leancloud_visitors" data-flag-title="å£°æ˜å¼httpå®¢æˆ·ç«¯openfeignçš„ç ”ç©¶ä¸åº”ç”¨" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/openfeign_research_and_application.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/openfeign_research_and_application.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><h2 id="openfeign"><a href="#openfeign" class="headerlink" title="openfeign"></a>openfeign</h2><p>openfeignï¼Œç®€ç§°feignï¼Œæ˜¯netflixå¼€æºçš„æŠ€æœ¯æ ˆä¹‹ä¸€ã€‚<br>feignçš„ä¸»æ—¨æ˜¯ä½¿å¾—ç¼–å†™java httpå®¢æˆ·ç«¯æ›´å®¹æ˜“ã€‚ä¸ºäº†è´¯å½»è¿™ä¸ªç†å¿µï¼Œfeigné‡‡ç”¨äº†é€šè¿‡å¤„ç†æ³¨è§£æ¥è‡ªåŠ¨ç”Ÿæˆè¯·æ±‚çš„æ–¹å¼ï¼ˆå®˜æ–¹ç§°å‘¼ä¸º<code>å£°æ˜å¼</code>ã€<code>æ¨¡æ¿åŒ–</code>ï¼‰ã€‚å› æ­¤ï¼ŒåŸºäºfeignç¼–å†™çš„httpå®¢æˆ·ç«¯ç”»é£çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Bank</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestLine</span><span class="token punctuation">(</span><span class="token string">"POST /account/{id}"</span><span class="token punctuation">)</span>
  Account <span class="token function">getAccountInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> String id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åé€šè¿‡ä¸€ç³»åˆ—æ“ä½œå¯ä»¥ä¸ºBankæ¥å£åœ¨è¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„å®ç°ã€‚é€šè¿‡è¿™ä¸ªå®ç°æˆ‘ä»¬å°±å¯ä»¥åœ¨javaä¸­åƒè°ƒç”¨ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ä¸€æ ·å®Œæˆä¸€æ¬¡httpè¯·æ±‚ï¼Œå¤§å¤§å‡å°‘äº†ç¼–ç æˆæœ¬ï¼ŒåŒæ—¶æé«˜äº†ä»£ç å¯è¯»æ€§ã€‚</p>
<h2 id="spring-cloud-openfeign"><a href="#spring-cloud-openfeign" class="headerlink" title="spring-cloud-openfeign"></a>spring-cloud-openfeign</h2><p>spring-cloud-feignåŸºäºè‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼ˆautoconfigurationï¼‰ï¼Œä¸ºspring bootåº”ç”¨æä¾›openfiegnçš„é›†æˆï¼š</p>
<ul>
<li>æ”¯æŒé€šè¿‡<code>JAX-RS</code>æˆ–<code>Spring MVC annotations</code>æ¥æ„å»ºfeign client</li>
<li>è‡ªåŠ¨ä½¿ç”¨Spring MVCçš„<code>HttpMessageConverters</code>æ¥å®Œæˆåºåˆ—åŒ–ååºåˆ—åŒ–</li>
<li>é›†æˆäº†<code>ribbon</code>å’Œ<code>hystrix</code>ï¼Œåªè¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ç›¸å…³çš„ä¾èµ–å³å¯ç«‹å³ä½¿ç”¨</li>
<li>æ— éœ€ä»»ä½•é…ç½®ï¼Œå¼€ç®±å³ç”¨ï¼Œç§‰æ‰¿äº†spring-bootä¸€è´¯çš„ä½œé£ã€‚</li>
</ul>
<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-openfeign/blob/master/docs/src/main/asciidoc/spring-cloud-openfeign.adoc" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£å‚è€ƒ</a></p>
</blockquote>
<h1 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h1><h2 id="å¤„ç†å“åº”æ•°æ®çš„é€šç”¨éƒ¨åˆ†"><a href="#å¤„ç†å“åº”æ•°æ®çš„é€šç”¨éƒ¨åˆ†" class="headerlink" title="å¤„ç†å“åº”æ•°æ®çš„é€šç”¨éƒ¨åˆ†"></a>å¤„ç†å“åº”æ•°æ®çš„é€šç”¨éƒ¨åˆ†</h2><p>apiå“åº”æ•°æ®æ ¼å¼ï¼Œä¸€èˆ¬è€Œè¨€é™¤å®é™…çš„ä¸šåŠ¡æ•°æ®å¤–æ˜¯å›ºå®šçš„æ ¼å¼ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¯¹æ­¤æ¬¡è¯·æ±‚çš„å¤„ç†ä¿¡æ¯æè¿°ã€‚å¯¹äºè¿™éƒ¨åˆ†æ•°æ®ï¼Œåº”ç”±feignè¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>feignclientæ˜¯é€šè¿‡Decoderæ¥å¯¹è¯·æ±‚å“åº”è¿›è¡Œå¤„ç†çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„Decoderæ¥å¤„ç†å“åº”æ•°æ®çš„é€šç”¨éƒ¨åˆ†ã€‚</p>
<p>ä¾‹å¦‚å¯ä»¥å®šä¹‰ä¸€ä¸ª<code>UnwrapRestfulApiResponseSpringDecoder</code>æ¥å¯¹<code>RestfulApiResponse</code>è¿›è¡Œè‡ªåŠ¨æ‹†åŒ…æ“ä½œï¼Œå¹¶é€šè¿‡<code>@FeignClient</code>çš„<code>configuration</code>å±æ€§é…ç½®å…¶ä½¿ç”¨çš„Decoderã€‚</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>name <span class="token operator">=</span> AuthCenter<span class="token punctuation">.</span>SERVICE_NAME<span class="token punctuation">,</span> path <span class="token operator">=</span> RMIPath<span class="token punctuation">.</span>USER<span class="token punctuation">,</span> configuration <span class="token operator">=</span> TenantUserClient<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TenantUserClient</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Autowired</span>
        <span class="token keyword">private</span> ObjectFactory<span class="token operator">&lt;</span>HttpMessageConverters<span class="token operator">></span> messageConverters<span class="token punctuation">;</span>

        <span class="token annotation punctuation">@Bean</span>
        <span class="token keyword">public</span> Decoder <span class="token function">feignDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntityDecoder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UnwrapRestfulApiResponseSpringDecoder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageConverters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="æœ¬åœ°è°ƒç”¨éœ€è¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒå¯¼è‡´æœåŠ¡ä¸å¯ç”¨çš„é—®é¢˜"><a href="#æœ¬åœ°è°ƒç”¨éœ€è¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒå¯¼è‡´æœåŠ¡ä¸å¯ç”¨çš„é—®é¢˜" class="headerlink" title="æœ¬åœ°è°ƒç”¨éœ€è¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒå¯¼è‡´æœåŠ¡ä¸å¯ç”¨çš„é—®é¢˜"></a>æœ¬åœ°è°ƒç”¨éœ€è¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒå¯¼è‡´æœåŠ¡ä¸å¯ç”¨çš„é—®é¢˜</h2><p>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶ä¼šå‡ºç°éœ€è¦åœ¨æœ¬åœ°è°ƒç”¨è¿œç¨‹æœåŠ¡æ¥è¿›è¡Œè°ƒè¯•çš„æƒ…å†µï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦å°†æœ¬åœ°çš„åº”ç”¨æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒã€‚è€Œä¸€æ—¦è¿™æ ·åšï¼Œä¼šå¯¼è‡´è¯¥æœåŠ¡å­˜åœ¨å¤šä¸ªèŠ‚ç‚¹ï¼ˆä¸€ä¸ªè¿œç¨‹ä¸€ä¸ªæœ¬åœ°ï¼‰ï¼Œä»è€Œå¯¼è‡´ä¾èµ–è¯¥æœåŠ¡çš„åº”ç”¨è½¯è´Ÿè½½å‡è¡¡è´Ÿè½½åˆ°æœ¬åœ°èŠ‚ç‚¹æ—¶ä¼šå¤±è´¥ã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="1-ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–ä¿¡æ¯ï¼Œä½¿ç”¨ç›´æ¥æŒ‡å®šurlçš„æ–¹å¼è°ƒç”¨ï¼ˆâœ˜ä¸æ¨èï¼‰"><a href="#1-ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–ä¿¡æ¯ï¼Œä½¿ç”¨ç›´æ¥æŒ‡å®šurlçš„æ–¹å¼è°ƒç”¨ï¼ˆâœ˜ä¸æ¨èï¼‰" class="headerlink" title="1. ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–ä¿¡æ¯ï¼Œä½¿ç”¨ç›´æ¥æŒ‡å®šurlçš„æ–¹å¼è°ƒç”¨ï¼ˆâœ˜ä¸æ¨èï¼‰"></a>1. ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–ä¿¡æ¯ï¼Œä½¿ç”¨ç›´æ¥æŒ‡å®šurlçš„æ–¹å¼è°ƒç”¨ï¼ˆâœ˜ä¸æ¨èï¼‰</h4><p><strong>å‚è€ƒä»£ç </strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sysinfo-service"</span> <span class="token punctuation">,</span>url <span class="token operator">=</span> <span class="token string">"http://49.4.7.72"</span><span class="token punctuation">,</span> path <span class="token operator">=</span> <span class="token string">"/"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SysinfoClient</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>æ­¤æ–¹æ¡ˆä¼˜ç‚¹æ˜¯ç®€å•æ˜“ç”¨ï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š</p>
<ol>
<li>åœ¨åº”ç”¨å®é™…ä¸Šçº¿æ—¶éœ€è¦å°†è°ƒç”¨æ–¹å¼ä¿®æ”¹ä¸ºé€šè¿‡æ³¨å†Œä¸­å¿ƒè°ƒç”¨ï¼Œå¦åˆ™clientå°†æ— æ³•è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå› æ­¤éœ€è¦é¢‘ç¹æ”¹åŠ¨ä»£ç </li>
<li>åœ¨ç‰¹å®šç¯å¢ƒä¸‹ï¼Œå³ä½¿å¿˜è®°åˆ‡æ¢è°ƒç”¨æ–¹å¼æœ‰æ—¶ä¹Ÿä¸å½±å“clientçš„ä½¿ç”¨ï¼Œä¼šå°†é—®é¢˜éšè—ï¼ŒåŸ‹ä¸‹éšæ‚£</li>
<li>å¹¶æ²¡æœ‰ä¸å…¶å®ƒæœåŠ¡çœŸæ­£åœ°è§£è€¦ï¼Œä¸€æ—¦ä¾èµ–çš„æœåŠ¡æ•…éšœå°±ä¼šå¯¼è‡´æœ¬åœ°å¼€å‘æ— æ³•è¿›è¡Œ</li>
</ol>
<p>ç”±äºå­˜åœ¨ä¸Šè¿°ç¼ºç‚¹ï¼Œç°ä¸€èˆ¬<strong>ä¸æ¨è</strong>ä½¿ç”¨è¯¥æ–¹æ¡ˆã€‚</p>
<h4 id="2-ä½¿ç”¨æ‰“æ¡©çš„æ–¹å¼ä¸è¿œç¨‹æœåŠ¡è§£è€¦ï¼ˆâœ”æ¨èï¼‰"><a href="#2-ä½¿ç”¨æ‰“æ¡©çš„æ–¹å¼ä¸è¿œç¨‹æœåŠ¡è§£è€¦ï¼ˆâœ”æ¨èï¼‰" class="headerlink" title="2. ä½¿ç”¨æ‰“æ¡©çš„æ–¹å¼ä¸è¿œç¨‹æœåŠ¡è§£è€¦ï¼ˆâœ”æ¨èï¼‰"></a>2. ä½¿ç”¨æ‰“æ¡©çš„æ–¹å¼ä¸è¿œç¨‹æœåŠ¡è§£è€¦ï¼ˆâœ”æ¨èï¼‰</h4><p>å¤§è‡´æ€è·¯ä¸ºï¼Œé€šè¿‡Springçš„<code>@Profile</code>æ³¨è§£ï¼Œåœ¨ä¸åŒçš„ç¯å¢ƒä¸ºåº”ç”¨æ³¨å†Œä¸åŒçš„client beanï¼ˆä¾‹å¦‚åœ¨æœ¬åœ°ç¯å¢ƒä½¿ç”¨Hard Code beanï¼Œè€Œåœ¨éæœ¬åœ°ç¯å¢ƒåˆ™ä½¿ç”¨è¿œç¨‹è°ƒç”¨çš„client beanï¼‰ã€‚</p>
<p><strong>å‚è€ƒä»£ç </strong><br><strong>ClientConfiguration.java</strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@EnableAuthClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.cheegu.icm.biz.foo.client"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>SpringProfiles<span class="token punctuation">.</span>DEV<span class="token punctuation">,</span> SpringProfiles<span class="token punctuation">.</span>TEST<span class="token punctuation">,</span> SpringProfiles<span class="token punctuation">.</span>PROD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientConfiguration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>MockClientConfiguration.java</strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span>SpringProfiles<span class="token punctuation">.</span>LOCAL<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MockClientConfiguration</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> SysinfoClient <span class="token function">sysinfoClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SysinfoClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> UserInfoDto <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UserInfoDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> TableData<span class="token operator">&lt;</span>UserRowDto<span class="token operator">></span> <span class="token function">users</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> TableData<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> TenantUserClient <span class="token function">tenantUserClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TenantUserClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> List<span class="token operator">&lt;</span>ResourceInfoDto<span class="token operator">></span> <span class="token function">listMyAlResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="å¦‚ä½•åœ¨è°ƒç”¨æ—¶å¸¦ä¸Šè¯·æ±‚å¤´"><a href="#å¦‚ä½•åœ¨è°ƒç”¨æ—¶å¸¦ä¸Šè¯·æ±‚å¤´" class="headerlink" title="å¦‚ä½•åœ¨è°ƒç”¨æ—¶å¸¦ä¸Šè¯·æ±‚å¤´"></a>å¦‚ä½•åœ¨è°ƒç”¨æ—¶å¸¦ä¸Šè¯·æ±‚å¤´</h2><p>åœ¨ä½¿ç”¨å®¢æˆ·ç«¯è¿›è¡Œè°ƒç”¨æ—¶ï¼Œæœ‰æ—¶ä¼šéœ€è¦å¸¦ä¸ŠæŸäº›è¯·æ±‚å¤´ï¼ˆä¾‹å¦‚è®¤è¯tokenï¼‰ï¼Œä½†åˆä¸å¸Œæœ›åœ¨ä»£ç ä¸­æ‰‹åŠ¨å»åšè¿™äº›æ“ä½œã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>å¯ä»¥é€šè¿‡å®ç°feignæä¾›çš„<code>RequestInterceptor</code>æ¥å£æ¥å¯¹è¯·æ±‚è¿›è¡Œåˆ‡é¢å¤„ç†ã€‚è¿™æ ·æ¯æ¬¡é€šè¿‡clientå‘èµ·è¯·æ±‚æ—¶éƒ½ä¼šç”±feign interceptorè¿›è¡Œæ‹¦æˆªï¼Œä¸ºè¯·æ±‚æ·»åŠ headersã€‚</p>
<p><strong>å‚è€ƒä»£ç </strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">EnvironmentAware</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Environment environment<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> AuthorizationInfoForwardingInterceptor <span class="token function">authorizationInfoForwardingInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//è¿™ä¸ªinterceptorä¼šä¸ºè¯·æ±‚è‡ªåŠ¨å¸¦ä¸Šè®¤è¯token</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationInfoForwardingInterceptor</span><span class="token punctuation">(</span>environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"spring.application.name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEnvironment</span><span class="token punctuation">(</span>Environment environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>environment <span class="token operator">=</span> environment<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="æŒ‡å®šäº†getæ–¹æ³•ï¼Œä½†feignä»ç„¶ä½¿ç”¨äº†postæ–¹æ³•è¿›è¡Œè¯·æ±‚"><a href="#æŒ‡å®šäº†getæ–¹æ³•ï¼Œä½†feignä»ç„¶ä½¿ç”¨äº†postæ–¹æ³•è¿›è¡Œè¯·æ±‚" class="headerlink" title="æŒ‡å®šäº†getæ–¹æ³•ï¼Œä½†feignä»ç„¶ä½¿ç”¨äº†postæ–¹æ³•è¿›è¡Œè¯·æ±‚"></a>æŒ‡å®šäº†getæ–¹æ³•ï¼Œä½†feignä»ç„¶ä½¿ç”¨äº†postæ–¹æ³•è¿›è¡Œè¯·æ±‚</h2><p>å¦‚ä¸‹ä»£ç æ‰€ç¤º</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span><span class="token string">"microservice-provider-user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserFeignClient</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/get"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
  <span class="token keyword">public</span> User <span class="token function">get0</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€šè¿‡<code>@RequestMapping</code>çš„methodå±æ€§æŒ‡å®šäº†è¯·æ±‚æ–¹æ³•ä¸ºGETï¼Œä½†å®é™…è¿è¡Œä¼šå‘ç°feignä»ç„¶ä½¿ç”¨äº†POSTæ–¹æ³•è¿›è¡Œäº†è°ƒç”¨ã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-3"><a href="#è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è¿™ç§å†™æ³•å¹¶ä¸æ­£ç¡®ï¼Œæ­£ç¡®å†™æ³•æœ‰äºŒï¼š</p>
<h4 id="1-é€šè¿‡-RequestParamæŒ‡å®šurlå‚æ•°å"><a href="#1-é€šè¿‡-RequestParamæŒ‡å®šurlå‚æ•°å" class="headerlink" title="1. é€šè¿‡@RequestParamæŒ‡å®šurlå‚æ•°å"></a>1. é€šè¿‡@RequestParamæŒ‡å®šurlå‚æ•°å</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"microservice-provider-user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserFeignClient</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/get"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
  <span class="token keyword">public</span> User <span class="token function">get1</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> Long id<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> String username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="2-å½“ç›®æ ‡urlå‚æ•°è¾ƒå¤šæ—¶ï¼Œå¯ä½¿ç”¨mapæ¥æ„å»º"><a href="#2-å½“ç›®æ ‡urlå‚æ•°è¾ƒå¤šæ—¶ï¼Œå¯ä½¿ç”¨mapæ¥æ„å»º" class="headerlink" title="2. å½“ç›®æ ‡urlå‚æ•°è¾ƒå¤šæ—¶ï¼Œå¯ä½¿ç”¨mapæ¥æ„å»º"></a>2. å½“ç›®æ ‡urlå‚æ•°è¾ƒå¤šæ—¶ï¼Œå¯ä½¿ç”¨mapæ¥æ„å»º</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"microservice-provider-user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserFeignClient</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/get"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
  <span class="token keyword">public</span> User <span class="token function">get2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ä½¿ç”¨MultipartFileç±»å‹ä½œä¸ºè¯·æ±‚å‚æ•°"><a href="#ä½¿ç”¨MultipartFileç±»å‹ä½œä¸ºè¯·æ±‚å‚æ•°" class="headerlink" title="ä½¿ç”¨MultipartFileç±»å‹ä½œä¸ºè¯·æ±‚å‚æ•°"></a>ä½¿ç”¨MultipartFileç±»å‹ä½œä¸ºè¯·æ±‚å‚æ•°</h2><p>æœ‰æ—¶å¯¹å¤–æä¾›çš„æ¥å£è°ƒç”¨å¯èƒ½éœ€è¦ä¼ é€æ–‡ä»¶ï¼Œæ­¤æ—¶éœ€è¦å¯¹<code>MultipartFile</code>ç±»å‹çš„å‚æ•°è¿›è¡Œå¤„ç†</p>
<h3 id="è§£å†³æ–¹æ¡ˆ-4"><a href="#è§£å†³æ–¹æ¡ˆ-4" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p><strong>å¾…è¡¥å……</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/outbound_rule_invalid_cause_by_urlrewritefilter_and_shirofilter.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/outbound_rule_invalid_cause_by_urlrewritefilter_and_shirofilter.html" class="post-title-link" itemprop="url">åŒæ—¶é…ç½®UrlRewriteFilterä¸ShiroFilterå¯¼è‡´outbound ruleå¤±æ•ˆçš„é—®é¢˜</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-21 16:10:51" itemprop="dateCreated datePublished" datetime="2017-12-21T16:10:51+08:00">2017-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/è¸©å‘æ—¥è®°/" itemprop="url" rel="index"><span itemprop="name">è¸©å‘æ—¥è®°</span></a>
                </span>
            </span>

          
            <span id="/outbound_rule_invalid_cause_by_urlrewritefilter_and_shirofilter.html" class="post-meta-item leancloud_visitors" data-flag-title="åŒæ—¶é…ç½®UrlRewriteFilterä¸ShiroFilterå¯¼è‡´outbound ruleå¤±æ•ˆçš„é—®é¢˜" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/outbound_rule_invalid_cause_by_urlrewritefilter_and_shirofilter.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/outbound_rule_invalid_cause_by_urlrewritefilter_and_shirofilter.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="é¡¹ç›®ç¯å¢ƒ"><a href="#é¡¹ç›®ç¯å¢ƒ" class="headerlink" title="é¡¹ç›®ç¯å¢ƒ"></a>é¡¹ç›®ç¯å¢ƒ</h2><p>Spring Boot1.5.4 + Shiro1.4.0 + UrlRewriteFilter4.0.4</p>
<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­åŒæ—¶ç”¨åˆ°<a href="http://shiro.apache.org/" target="_blank" rel="noopener">Shiro</a>å’Œ<a href="http://www.tuckey.org/urlrewrite/" target="_blank" rel="noopener">UrlRewriteFilter</a>ã€‚ç”±äºåœ¨webç¯å¢ƒä¸‹ä¸¤è€…éƒ½æ˜¯é€šè¿‡é…ç½®filteræ¥å®ç°åŠŸèƒ½çš„ï¼Œå› æ­¤å¯¼è‡´å‡ºç°äº†å†²çªâ€”â€”UrlRewriteFilterçš„outbound ruleæ— æ³•æ­£å¸¸å·¥ä½œã€‚å…·ä½“è¡¨ç°ä¸ºï¼š</p>
<p>åœ¨urlrewrite.xmlä¸­é…ç½®äº†</p>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>urlrewrite</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>outbound-rule</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>/in-rewrite\?type=(\w+)$<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>/in/$1.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>outbound-rule</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>urlrewrite</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨javaä»£ç ä¸­å®šä¹‰action</p>
<pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"out-rewrite"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> String <span class="token function">out</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span><span class="token string">"localhost:8080/in-rewrite?type=233"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//will be rewrite to 'localhost:8080/in/233.html'</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ­£å¸¸æ¥è¯´ï¼Œè®¿é—®è¿™ä¸ªapiåº”è¯¥è¿”å›â€localhost:8080/in/233.htmlâ€æ‰å¯¹ï¼Œä½†å´è¿”å›äº†æœªè½¬æ¢å‰çš„urlï¼Œå³â€localhost:8080/in-rewrite?type=233â€ã€‚</p>
<h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p>åœ¨è°ƒè¯•æºç çš„æ—¶å€™å‘ç°ï¼ŒåŒæ—¶é…ç½®äº†ShiroFilterå’ŒUrlRewriteFilteræ—¶ï¼Œresponseçš„ç±»å‹æ˜¯<code>ShiroHttpServletResponse</code>ï¼Œæ­¤æ—¶outbound ruleæ˜¯ä¸èµ·ä½œç”¨çš„ã€‚è€ŒæŠŠShiroFilterçš„é…ç½®å»æ‰ï¼Œåªç•™ä¸‹UrlRewriteFilteræ—¶ï¼Œresponseçš„ç±»å‹åˆ™æ˜¯<code>UrlRewriteWrappedResponse</code>ï¼Œè€Œæ­¤æ—¶outbound ruleæ˜¯èµ·ä½œç”¨çš„ã€‚æ˜¾ç„¶ï¼Œä¸¤è€…åœ¨filteré‡Œé¢éƒ½å¯¹responseè¿›è¡Œäº†é‡æ–°åŒ…è£…ï¼Œè€ŒShiroFilteræ‰§è¡Œåœ¨åï¼Œå¯¼è‡´å‰è€…çš„éƒ¨åˆ†åŠŸèƒ½å¤±æ•ˆã€‚</p>
<p>å†æŸ¥çœ‹ä¸Šé¢ä¸¤ä¸ªresponseåŒ…è£…ç±»çš„æºç ï¼š</p>
<p><strong>UrlRewriteWrappedResponse.java</strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> String <span class="token function">encodeURL</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        RewrittenOutboundUrl rou <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processPreEncodeURL</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rou <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rou<span class="token punctuation">.</span><span class="token function">isEncode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                rou<span class="token punctuation">.</span><span class="token function">setTarget</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span>rou<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processPostEncodeURL</span><span class="token punctuation">(</span>rou<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>ShiroHttpServletResponse.java</strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> String <span class="token function">encodeURL</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        String absolute <span class="token operator">=</span> <span class="token function">toAbsolute</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEncodeable</span><span class="token punctuation">(</span>absolute<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// W3c spec clearly said</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                url <span class="token operator">=</span> absolute<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">toEncoded</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> url<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å‘ç°ä¸¤è€…å‡å¯¹<code>encodeUrl</code>ã€<code>encodeRedirectUrl</code>ç­‰å››ä¸ªæ–¹æ³•è¿›è¡Œäº†æ”¹å†™ã€‚Shiroçš„åŒ…è£…ç±»æ‰§è¡Œåœ¨åï¼Œå¯¼è‡´<code>UrlRewriteWrappedResponse</code>çš„ç›¸å…³ä»£ç æ²¡æœ‰è¢«æ‰§è¡Œã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="é‡æ’Filterçš„æ‰§è¡Œé¡ºåº"><a href="#é‡æ’Filterçš„æ‰§è¡Œé¡ºåº" class="headerlink" title="é‡æ’Filterçš„æ‰§è¡Œé¡ºåº"></a>é‡æ’Filterçš„æ‰§è¡Œé¡ºåº</h3><p>è®©<code>UrlRewriteWrappedResponse</code>çš„åŒ…è£…è¿‡ç¨‹æ‰§è¡Œåœ¨åï¼Œé¿å…encodeUrlæ–¹æ³•è¢«æ”¹å†™ã€‚</p>
<p>æ˜¾ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå¥½çš„åŠæ³•ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li>å¯¼è‡´<code>ShiroHttpServletResponse</code>çš„æ–¹æ³•è¢«æ”¹å†™ï¼Œå¯èƒ½å¼•å‡ºå…¶å®ƒæœªçŸ¥é—®é¢˜ï¼Œæ— å¼‚äºæ‹†ä¸œå¢™è¡¥è¥¿å¢™</li>
<li>å¯¼è‡´ShiroFilteræ‰§è¡Œåœ¨å‰ï¼Œå¯èƒ½å¯¼è‡´ä¸€äº›è®¿é—®çš„urlè¿˜æœªè¢«é‡å†™ï¼Œè¿™æ¬¡è®¿é—®å°±è¢«Shiroæ‹¦æˆªäº†</li>
</ol>
<h3 id="è‡ªå·±å®ç°encodeUrlçš„é€»è¾‘"><a href="#è‡ªå·±å®ç°encodeUrlçš„é€»è¾‘" class="headerlink" title="è‡ªå·±å®ç°encodeUrlçš„é€»è¾‘"></a>è‡ªå·±å®ç°encodeUrlçš„é€»è¾‘</h3><p>è®©<code>ShiroHttpServletResponse</code>æ‰§è¡Œencodeå‰å…ˆæ‰§è¡Œ<code>UrlRewriteWrappedResponse</code>çš„encodeä»£ç ã€‚</p>
<ol>
<li><p>æ”¹å†™<code>ShiroHttpServletResponse</code>ï¼Œé‡å†™å…¶encodeé€»è¾‘</p>
<pre class="line-numbers language-java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomShiroHttpServletResponse</span> <span class="token keyword">extends</span> <span class="token class-name">ShiroHttpServletResponse</span> <span class="token punctuation">{</span>
     <span class="token keyword">private</span> HttpServletResponse wrapped<span class="token punctuation">;</span>

     <span class="token keyword">public</span> <span class="token function">CustomShiroHttpServletResponse</span><span class="token punctuation">(</span>HttpServletResponse wrapped<span class="token punctuation">,</span> ServletContext context<span class="token punctuation">,</span> ShiroHttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">super</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">,</span> context<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>wrapped <span class="token operator">=</span> wrapped<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> String <span class="token function">encodeRedirectURL</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeRedirectURL</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">.</span><span class="token function">encodeRedirectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> String <span class="token function">encodeRedirectUrl</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeRedirectUrl</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">.</span><span class="token function">encodeRedirectUrl</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> String <span class="token function">encodeURL</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">public</span> String <span class="token function">encodeUrl</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">encodeUrl</span><span class="token punctuation">(</span>wrapped<span class="token punctuation">.</span><span class="token function">encodeUrl</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>æ”¹å†™<code>ShiroFilter</code>ï¼Œä½¿ç”¨<code>CustomShiroHttpServletResponse</code>ä»£æ›¿<code>ShiroHttpServletResponse</code></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomSpringShiroFilter</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractShiroFilter</span> <span class="token punctuation">{</span>
 <span class="token keyword">protected</span> <span class="token function">CustomSpringShiroFilter</span><span class="token punctuation">(</span>WebSecurityManager webSecurityManager<span class="token punctuation">,</span> FilterChainResolver resolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment" spellcheck="true">//è¿™æ®µä»£ç æ˜¯copyäº†ShiroFilterFactoryBean$SpringShiroFilterçš„æ„é€ æ–¹æ³•ä¸­çš„ä»£ç </span>
     <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>webSecurityManager <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"WebSecurityManager property cannot be null."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token function">setSecurityManager</span><span class="token punctuation">(</span>webSecurityManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>resolver <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token function">setFilterChainResolver</span><span class="token punctuation">(</span>resolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 <span class="token annotation punctuation">@Override</span>
 <span class="token keyword">protected</span> ServletResponse <span class="token function">wrapServletResponse</span><span class="token punctuation">(</span>HttpServletResponse orig<span class="token punctuation">,</span> ShiroHttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment" spellcheck="true">//ä½¿ç”¨CustomShiroHttpServletResponseä»£æ›¿åŸæœ‰çš„Response Wrapper</span>
     <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CustomShiroHttpServletResponse</span><span class="token punctuation">(</span>orig<span class="token punctuation">,</span> <span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>ç„¶åæ”¹å†™<code>ShiroFilterFactoryBean</code>çš„createInstanceæ–¹æ³•ï¼Œä½¿ç”¨<code>CustomSpringShiroFilter</code>ï¼Œä»£æ›¿åŸæ¥çš„Filter</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomShiroFilterFactoryBean</span> <span class="token keyword">extends</span> <span class="token class-name">ShiroFilterFactoryBean</span> <span class="token punctuation">{</span>
 <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">transient</span> <span class="token keyword">final</span> Logger log <span class="token operator">=</span> LoggerFactory<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>ShiroFilterFactoryBean<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token annotation punctuation">@Override</span>
 <span class="token keyword">protected</span> AbstractShiroFilter <span class="token function">createInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
     <span class="token comment" spellcheck="true">//è¿™éƒ¨åˆ†ä»£ç ä¸çˆ¶ç±»ç›¸åŒ</span>
     log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Creating Shiro Filter instance."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     SecurityManager securityManager <span class="token operator">=</span> <span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>securityManager <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         String msg <span class="token operator">=</span> <span class="token string">"SecurityManager property must be set."</span><span class="token punctuation">;</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanInitializationException</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>securityManager <span class="token keyword">instanceof</span> <span class="token class-name">WebSecurityManager</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         String msg <span class="token operator">=</span> <span class="token string">"The security manager does not implement the WebSecurityManager interface."</span><span class="token punctuation">;</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanInitializationException</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     FilterChainManager manager <span class="token operator">=</span> <span class="token function">createFilterChainManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     PathMatchingFilterChainResolver chainResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PathMatchingFilterChainResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     chainResolver<span class="token punctuation">.</span><span class="token function">setFilterChainManager</span><span class="token punctuation">(</span>manager<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment" spellcheck="true">//ä½¿ç”¨CustomSpringShiroFilterä»£æ›¿SpringShiroFilter</span>
     <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CustomSpringShiroFilter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>WebSecurityManager<span class="token punctuation">)</span> securityManager<span class="token punctuation">,</span> chainResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>é‡å¯é¡¹ç›®ï¼Œè®¿é—®â€/out-rewriteâ€ï¼Œç»“æœå¦‚ä¸‹<br><img src="/images/20171221/outbound.png" alt="outbound rule"></p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://taccisum.github.io/instantiationexception_on_mybatistest.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="taccisum">
      <meta itemprop="description" content="el psy congroo.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Taccisum's blog ğŸ˜‰">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/instantiationexception_on_mybatistest.html" class="post-title-link" itemprop="url">åœ¨@MybatisTestä¸­ä½¿ç”¨é€šç”¨Mapperå‡ºç°InstantiationExceptionçš„é—®é¢˜</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-11-15 11:42:36" itemprop="dateCreated datePublished" datetime="2017-11-15T11:42:36+08:00">2017-11-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-03-13 18:05:01" itemprop="dateModified" datetime="2020-03-13T18:05:01+08:00">2020-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/è¸©å‘æ—¥è®°/" itemprop="url" rel="index"><span itemprop="name">è¸©å‘æ—¥è®°</span></a>
                </span>
            </span>

          
            <span id="/instantiationexception_on_mybatistest.html" class="post-meta-item leancloud_visitors" data-flag-title="åœ¨@MybatisTestä¸­ä½¿ç”¨é€šç”¨Mapperå‡ºç°InstantiationExceptionçš„é—®é¢˜" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/instantiationexception_on_mybatistest.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/instantiationexception_on_mybatistest.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åœ¨Spring Bootç¯å¢ƒä¸­ä½¿ç”¨<a href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-test-autoconfigure/" target="_blank" rel="noopener">@MybatisTest</a>æ³¨è§£é’ˆå¯¹Mapperå†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œç”±äºåŒæ—¶å¼•å…¥äº†<a href="https://github.com/abel533/Mapper" target="_blank" rel="noopener">é€šç”¨Mapper</a>ï¼Œåœ¨å•å…ƒæµ‹è¯•ä¸­è°ƒç”¨é€šç”¨Mapperçš„æ–¹æ³•è¿›è¡ŒCRUDæ—¶ä¼šå‡ºç°<code>InstantiationException</code>å¼‚å¸¸</p>
<pre class="line-numbers language-java"><code class="language-java">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>MyBatisSystemException<span class="token operator">:</span> nested exception is org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>BuilderException<span class="token operator">:</span> Error invoking SqlProvider <span class="token function">method</span> <span class="token punctuation">(</span>tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider<span class="token punctuation">.</span>dynamicSQL<span class="token punctuation">)</span><span class="token punctuation">.</span>  Cause<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>InstantiationException<span class="token operator">:</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider

    at org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>MyBatisExceptionTranslator<span class="token punctuation">.</span><span class="token function">translateExceptionIfPossible</span><span class="token punctuation">(</span>MyBatisExceptionTranslator<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">77</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>SqlSessionTemplate$SqlSessionInterceptor<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>SqlSessionTemplate<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">446</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>$Proxy89<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>Unknown Source<span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>SqlSessionTemplate<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>SqlSessionTemplate<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">166</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>binding<span class="token punctuation">.</span>MapperMethod<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>MapperMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">82</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>binding<span class="token punctuation">.</span>MapperProxy<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>MapperProxy<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">59</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>$Proxy91<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span>Unknown Source<span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>ikentop<span class="token punctuation">.</span>biz<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>hh<span class="token punctuation">.</span>ImageRecordMapperTest<span class="token punctuation">.</span><span class="token function">testSimply</span><span class="token punctuation">(</span>ImageRecordMapperTest<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke0</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>Method<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">498</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>model<span class="token punctuation">.</span>FrameworkMethod$<span class="token number">1</span><span class="token punctuation">.</span><span class="token function">runReflectiveCall</span><span class="token punctuation">(</span>FrameworkMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>model<span class="token punctuation">.</span>ReflectiveCallable<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ReflectiveCallable<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>model<span class="token punctuation">.</span>FrameworkMethod<span class="token punctuation">.</span><span class="token function">invokeExplosively</span><span class="token punctuation">(</span>FrameworkMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">47</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>InvokeMethod<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>InvokeMethod<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>RunBeforeTestMethodCallbacks<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>RunBeforeTestMethodCallbacks<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">75</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>RunAfterTestMethodCallbacks<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>RunAfterTestMethodCallbacks<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">86</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>SpringRepeat<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>SpringRepeat<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">84</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner<span class="token punctuation">.</span><span class="token function">runLeaf</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">325</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span><span class="token function">runChild</span><span class="token punctuation">(</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">252</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span><span class="token function">runChild</span><span class="token punctuation">(</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">94</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner$<span class="token number">3</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">290</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner$<span class="token number">1</span><span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">71</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner<span class="token punctuation">.</span><span class="token function">runChildren</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">288</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner<span class="token punctuation">.</span>access$<span class="token function">000</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">58</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner$<span class="token number">2</span><span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">268</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>RunBeforeTestClassCallbacks<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>RunBeforeTestClassCallbacks<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">61</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>statements<span class="token punctuation">.</span>RunAfterTestClassCallbacks<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>RunAfterTestClassCallbacks<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">70</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runners<span class="token punctuation">.</span>ParentRunner<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>ParentRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">363</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>SpringJUnit4ClassRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">191</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span>JUnitCore<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>JUnitCore<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">137</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>intellij<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>JUnit4IdeaTestRunner<span class="token punctuation">.</span><span class="token function">startRunnerWithArgs</span><span class="token punctuation">(</span>JUnit4IdeaTestRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">68</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>intellij<span class="token punctuation">.</span>rt<span class="token punctuation">.</span>execution<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>IdeaTestRunner$Repeater<span class="token punctuation">.</span><span class="token function">startRunnerWithArgs</span><span class="token punctuation">(</span>IdeaTestRunner<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">51</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>intellij<span class="token punctuation">.</span>rt<span class="token punctuation">.</span>execution<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>JUnitStarter<span class="token punctuation">.</span><span class="token function">prepareStreamsAndStart</span><span class="token punctuation">(</span>JUnitStarter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">237</span><span class="token punctuation">)</span>
    at com<span class="token punctuation">.</span>intellij<span class="token punctuation">.</span>rt<span class="token punctuation">.</span>execution<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>JUnitStarter<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span>JUnitStarter<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">70</span><span class="token punctuation">)</span>
Caused by<span class="token operator">:</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>BuilderException<span class="token operator">:</span> Error invoking SqlProvider <span class="token function">method</span> <span class="token punctuation">(</span>tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider<span class="token punctuation">.</span>dynamicSQL<span class="token punctuation">)</span><span class="token punctuation">.</span>  Cause<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>InstantiationException<span class="token operator">:</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ProviderSqlSource<span class="token punctuation">.</span><span class="token function">createSqlSource</span><span class="token punctuation">(</span>ProviderSqlSource<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">103</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ProviderSqlSource<span class="token punctuation">.</span><span class="token function">getBoundSql</span><span class="token punctuation">(</span>ProviderSqlSource<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">73</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span>MappedStatement<span class="token punctuation">.</span><span class="token function">getBoundSql</span><span class="token punctuation">(</span>MappedStatement<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">292</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>executor<span class="token punctuation">.</span>CachingExecutor<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>CachingExecutor<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>DefaultSqlSession<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">148</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>DefaultSqlSession<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">141</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>DefaultSqlSession<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>DefaultSqlSession<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">77</span><span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke0</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>NativeMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>NativeMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">)</span>
    at sun<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>DelegatingMethodAccessorImpl<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>Method<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">498</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>SqlSessionTemplate$SqlSessionInterceptor<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>SqlSessionTemplate<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">433</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">34</span> more
Caused by<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>InstantiationException<span class="token operator">:</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Class<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>Class<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">427</span><span class="token punctuation">)</span>
    at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ProviderSqlSource<span class="token punctuation">.</span><span class="token function">createSqlSource</span><span class="token punctuation">(</span>ProviderSqlSource<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">85</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">45</span> more
Caused by<span class="token operator">:</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoSuchMethodException<span class="token operator">:</span> tk<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>base<span class="token punctuation">.</span>BaseSelectProvider<span class="token punctuation">.</span>&lt;init<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Class<span class="token punctuation">.</span><span class="token function">getConstructor0</span><span class="token punctuation">(</span>Class<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">3082</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Class<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>Class<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">412</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">46</span> more
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å•å…ƒæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span>SpringRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@MybatisTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImageRecordMapperTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> ImageRecordMapper mapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSimply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ImageRecord record <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">assertNotNull</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">"taccisum"</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">getBucket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">"image1"</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">"hash1"</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="åˆ†æåŸå› "><a href="#åˆ†æåŸå› " class="headerlink" title="åˆ†æåŸå› "></a>åˆ†æåŸå› </h2><p>åœ¨githubä¸Šmapperçš„<a href="https://github.com/abel533/MyBatis-Spring-Boot/issues/34" target="_blank" rel="noopener">issue</a>ä¸­æœ‰ä¸€æ®µä½œè€…çš„å›å¤ï¼Œè¯´æ­¤å¼‚å¸¸æ˜¯ç”±äº<code>é€šç”¨æ–¹æ³•æ²¡æœ‰è¢«æ­£ç¡®åˆå§‹åŒ–</code>å¯¼è‡´ã€‚<br>æˆ‘è¿™è¾¹çš„æƒ…å†µè™½ç„¶å’Œè¿™ä¸ªissueä¸åŒï¼Œä½†æ ¹æœ¬åŸå› æ˜¯ä¸€æ ·çš„ã€‚<br>æŸ¥é˜…<code>Mybatis-Test</code>çš„æ–‡æ¡£å¯çŸ¥ï¼Œ<code>@MybatisTest</code>æ³¨è§£ä¸åŒäº<code>@SpringBootTest</code>ï¼Œå®ƒåªåŠ è½½ä¿è¯Mybatisæ­£å¸¸è¿è¡Œæ‰€éœ€è¦çš„configurationã€‚æ˜¾ç„¶é€šç”¨Mapperä½œä¸ºMybatisç¬¬ä¸‰æ–¹çš„æ‰©å±•ï¼Œå¹¶æ²¡æœ‰è¢«çº³å…¥å…¶ä¸­ï¼Œå› è€Œé»˜è®¤æƒ…å†µä¸‹é€šç”¨Mapperçš„starteræ˜¯ä¸ä¼šè¢«åŠ è½½çš„ï¼Œä¹Ÿå°±å¯¼è‡´é€šç”¨æ–¹æ³•ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚</p>
<blockquote>
<p>The @MybatisTest can be used if you want to test MyBatis components(Mapper interface and SqlSession). By default it will configure MyBatis(MyBatis-Spring) components(SqlSessionFactory and SqlSessionTemplate), configure MyBatis mapper interfaces and configure an in-memory embedded database. MyBatis tests are transactional and rollback at the end of each test by default, for more details refer to the relevant section in the Spring Reference Documentation. Also regular @Component beans will not be loaded into the ApplicationContext.<br>ä»¥ä¸Šæ˜¯æ¥è‡ª<a href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-test-autoconfigure/" target="_blank" rel="noopener">mybatis-spring-boot-test-autoconfigure</a>å®˜æ–¹æ–‡æ¡£çš„æè¿°</p>
</blockquote>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æ˜¾ç„¶ï¼Œåªè¦è®©Mapperçš„starteråœ¨MybatisTestçš„å•å…ƒæµ‹è¯•å¯åŠ¨æ—¶å¾—ä»¥åŠ è½½å³å¯è§£å†³æˆ‘ä»¬çš„é—®é¢˜ã€‚é‚£ä¹ˆå¦‚ä½•åšå‘¢ï¼Ÿ<br>Spring Bootæä¾›äº†ä¸€ä¸ª<code>@ImportAutoConfiguration</code>çš„æ³¨è§£ï¼Œå› æ­¤åªéœ€è¦åœ¨å•å…ƒæµ‹è¯•çš„ç›®æ ‡ç±»ä¸Šä½¿ç”¨è¯¥æ³¨è§£å°†MapperAutoConfigurationå¯¼å…¥å³å¯</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span>SpringRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ImportAutoConfiguration</span><span class="token punctuation">(</span>MapperAutoConfiguration<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@MybatisTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImageRecordMapperTest</span> <span class="token punctuation">{</span>
    â€¦â€¦
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­<code>MapperAutoConfiguration</code>æ˜¯é€šç”¨Mapperçš„starterçš„auto-configureç±»ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="taccisum"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">taccisum</p>
  <div class="site-description" itemprop="description">el psy congroo.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/taccisum" title="GitHub â†’ https://github.com/taccisum" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/taccisum@gmail.com" title="G-Mail â†’ taccisum@gmail.com"><i class="fa fa-envelope fa-fw"></i>G-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">taccisum</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'q1GTC85aQcIvQIf3p9tWLTvW-gzGzoHsz',
      appKey     : 'OjWCd5UV1xcOyCEfsSzu9w7z',
      placeholder: "æ¬¢è¿ç•…æ‰€æ¬²è¨€",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
